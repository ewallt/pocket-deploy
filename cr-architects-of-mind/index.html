<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Architects of the Mind</title>
  <!-- Tailwind + typography -->
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>
  <!-- Optional BLB tagger (safe to leave in) -->
  <script src="https://www.blueletterbible.org/scripts/blbToolTip/BLB_ScriptTagger-min.js"></script>
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
  <style>
    /* Typography */
    .font-newspaper{font-family:'Lora',serif}
    .font-dark-theme{font-family:'Lora',serif}
    body{transition:background .3s,color .3s}
    .prose h1{min-height:7.5rem}

    /* --- Classic Themes (Original) --- */
    .newspaper-theme{background:#fdfdfd;color:#1a1a1a}
    .newspaper-theme .nav-button{background:#f8f9fa;border:1px solid #dee2e6;color:#212529}
    .newspaper-theme .nav-button:hover{background:#e9ecef}
    .newspaper-theme .nav-button.active{background:#1a1a1a;color:#fdfdfd}

    .dark-theme{background:#2d2d30;color:#fff}
    .dark-theme .nav-button{background:#3c3c3c;border:1px solid #4a4a4a;color:#ccc}
    .dark-theme .nav-button:hover{background:#4a4a4a}
    .dark-theme .nav-button.active{background:#fff;color:#2d2d30}

    .nav-button:focus-visible{outline:2px solid var(--nav-border);outline-offset:2px}
    .variable-theme .prose a{color:var(--accent-text);text-underline-offset:2px}

    
    /* --- New Variable-Based Theme Engine --- */
    :root {
        --bg-gradient: #fdfdfd;
        --text: #1a1a1a;
        --accent-text: #1a1a1a;
        --nav-bg: #f8f9fa;
        --nav-border: #dee2e6;
        --nav-text: #212529;
        --nav-hover-bg: #e9ecef;
        --nav-active-bg: #1a1a1a;
        --nav-active-text: #fdfdfd;
    }
    
    .variable-theme {
        background: var(--bg-gradient);
        color: var(--text);
        font-family: 'Lora', serif;
    }
    .variable-theme .prose h1,
    .variable-theme .prose h2,
    .variable-theme .prose h3 {
        color: var(--accent-text);
    }
    .variable-theme .nav-button {
        background-color: var(--nav-bg);
        border: 1px solid var(--nav-border);
        color: var(--nav-text);
    }
    .variable-theme .nav-button:hover {
        background-color: var(--nav-hover-bg);
    }
    .variable-theme .nav-button.active {
        background-color: var(--nav-active-bg);
        color: var(--nav-active-text);
    }
    .variable-theme .nav-button.btn-dark-text.active,
    .variable-theme .nav-button.btn-dark-text:hover {
        color: var(--nav-active-text);
    }
    .variable-theme .nav-button.btn-light-text.active,
    .variable-theme .nav-button.btn-light-text:hover {
        color: var(--nav-active-text);
    }

    /* --- Shared & Modal Styles --- */
    .nav-container{margin-bottom:2rem}
    .nav-button{padding:.5rem 1rem;margin:.5rem .5rem .5rem 0;border-radius:.375rem;transition:all .2s;cursor:pointer}
    #library-switcher,#topic-switcher{padding:.5rem;border-radius:.375rem;margin-bottom:1rem;width:100%;border:1px solid #ccc}
    .nav-buttons-wrapper{display:flex;flex-wrap:wrap;align-items:center;width:100%}
    .flex-break{flex-basis:100%;height:0}

    .modal-overlay {
        display: none; position: fixed; z-index: 1000; left: 0; top: 0;
        width: 100%; height: 100%;
        background-color: rgba(0,0,0,0.6);
        justify-content: center; align-items: center;
    }
    .modal-overlay.show { display: flex; }
    .modal-content {
        background: #fff; color: #2d2d30; padding: 2rem; border-radius: 8px;
        text-align: center; position: relative; width: 90%; max-width: 400px;
    }
    .dark .modal-content { background: #2d2d30; color: #fff; }
    .modal-content h3 { font-size: 1.5rem; margin-bottom: 1.5rem; }
    .modal-content label { font-size: 1.1rem; margin-right: 10px; }
    #theme-select {
        background-color: #f0f0f0; color: #2d2d30;
        border: 1px solid #ccc; border-radius: 5px; padding: 8px; font-size: 1rem;
    }
    .dark #theme-select {
        background-color: #3c3c3c; color: #fff; border-color: #4a4a4a;
    }
    .close-btn {
        position: absolute; top: 10px; right: 15px; color: #aaa;
        font-size: 28px; font-weight: bold; background: none;
        border: none; cursor: pointer;
    }
  </style>
</head>
<body class="font-newspaper newspaper-theme">

  <script id="embedded-content" type="application/json">
    {
      "architects-of-the-mind": {
        "display_order": 10,
        "title": "Architects of the Mind",
        "description": "Profiles of the brilliant psychologists, economists, and thinkers who discovered and popularized the concepts of cognitive biases and mental models.",
        "categories": {
          "kahneman-tversky": {
            "display_order": 10,
            "name": "Daniel Kahneman & Amos Tversky: The Collaborative Mind",
            "display_name": "Kahneman & Tversky",
            "introduction": "The story of behavioral economics begins with the legendary collaboration between two Israeli psychologists, Daniel Kahneman and Amos Tversky. Their work systematically dismantled the idea of a perfectly rational 'homo economicus,' revealing the predictable, irrational shortcuts our minds take every day. Their partnership culminated in a Nobel Prize and created a new language for understanding human judgment and decision-making.",
            "paragraphs": [
              {
                "heading": "A Revolutionary Partnership",
                "content": "Kahneman, a self-doubting and cautious thinker, and Tversky, a supremely confident and brilliant optimist, formed one of the most fruitful intellectual partnerships of the 20th century. They worked by spending hours in intense, joyful debate, challenging each other's ideas until they arrived at a shared insight. Their process was so intertwined that they often couldn't remember who originated an idea, once joking they would flip a coin to decide authorship. This collaboration became the engine for a revolution in psychology."
              },
              {
                "heading": "Heuristics and Biases",
                "content": "Their foundational work identified 'heuristics'—mental shortcuts the brain uses to make quick judgments under uncertainty. While often useful, these heuristics lead to systematic errors, or 'biases.' They identified key biases like <strong>Anchoring</strong> (relying on the first piece of information), the <strong>Availability Heuristic</strong> (judging by what's easy to recall), and the <strong>Representativeness Heuristic</strong> (judging by stereotypes). They showed that human irrationality wasn't random, but predictable."
              },
              {
                "heading": "Prospect Theory",
                "content": "Their Nobel-winning contribution, Prospect Theory, described how people actually make decisions involving risk. It had two core insights that shattered traditional economics. First, decisions are based on a 'reference point,' not absolute outcomes. Second, and most famously, is <strong>loss aversion</strong>: the pain of a loss is psychologically about twice as powerful as the pleasure of an equivalent gain. This simple idea explained a vast range of previously puzzling economic behaviors, from stock market anomalies to consumer choices."
              },
              {
                "heading": "System 1 and System 2",
                "content": "In his later, bestselling book *Thinking, Fast and Slow*, Kahneman popularized a model of the mind with two characters. <strong>System 1</strong> is fast, intuitive, emotional, and effortless—it's your gut reaction. <strong>System 2</strong> is slow, deliberate, analytical, and requires effort—it's your conscious reasoning. He argued that most of our cognitive biases are the result of System 1 making a quick, intuitive judgment and System 2 being too lazy or busy to correct it. This framework made their academic work accessible to millions."
              },
              {
                "heading": "An Enduring Legacy",
                "content": "Though Tversky passed away before the Nobel Prize was awarded, their joint legacy is monumental. They didn't just create a list of mental quirks; they provided a comprehensive theory of human judgment that has reshaped not just psychology and economics, but also medicine, law, public policy, and business. They gave us the tools to understand why we fail, and the first hints at how we might do better."
              }
            ]
          },
          "charlie-munger": {
            "display_order": 20,
            "name": "Charlie Munger: The Latticework of Mental Models",
            "display_name": "Munger",
            "introduction": "Charlie Munger, the plainspoken vice chairman of Berkshire Hathaway and Warren Buffett's indispensable partner, is a unique figure in the world of ideas. A self-taught polymath, Munger translated the academic findings of psychology and other disciplines into a practical toolkit for making better decisions in business and life. His central idea is the 'latticework of mental models,' a framework for achieving worldly wisdom.",
            "paragraphs": [
              {
                "heading": "The Latticework of Mental Models",
                "content": "Munger's core philosophy is that to be a successful thinker, you cannot rely on the tools of a single discipline. As he famously said, 'To the man with only a hammer, every problem looks like a nail.' Instead, you must learn the big, foundational ideas from all the important fields—psychology, physics, biology, history, mathematics—and arrange them in your mind as a 'latticework.' This framework of interconnected models allows you to see a problem from multiple perspectives, leading to a more complete and accurate understanding of reality."
              },
              {
                "heading": "The Psychology of Human Misjudgment",
                "content": "Long before behavioral economics became popular, Munger was obsessed with the cognitive biases that lead smart people to do foolish things. He independently cataloged dozens of these tendencies in his famous speech, 'The Psychology of Human Misjudgment.' He argued that understanding these psychological forces—like the power of incentives, social proof, and loss aversion—was the most important thing for an investor. His focus was not on being brilliant, but on consistently <strong>avoiding stupidity</strong>."
              },
              {
                "heading": "'Invert, Always Invert'",
                "content": "One of Munger's most powerful mental models is inversion, a lesson he learned from the mathematician Carl Jacobi. Instead of asking how to achieve a goal (e.g., 'How can I make this company successful?'), you turn the problem upside down and ask what you should avoid (e.g., 'What could absolutely destroy this company?'). By identifying and rigorously avoiding the paths to failure, the path to success often becomes much clearer. As Munger says, 'It is remarkable how much long-term advantage people like us have gotten by trying to be consistently not stupid, instead of trying to be very intelligent.'"
              },
              {
                "heading": "Circle of Competence",
                "content": "A key mental model for Munger and Buffett is the 'circle of competence.' This is the simple but profound idea that you must know the boundaries of your own knowledge. The size of the circle is not important; knowing where the perimeter is, however, is vital. By staying within their circle of competence and only investing in businesses they truly understood, they avoided catastrophic mistakes that befell many of their more adventurous peers. It is a principle of intellectual honesty and humility."
              },
              {
                "heading": "A Legacy of Practical Wisdom",
                "content": "Charlie Munger's contribution is not in original scientific discovery, but in synthesis and application. He is the master of taking big ideas from academia and turning them into practical tools for decision-making. He showed generations of investors and thinkers that worldly wisdom is not about being the smartest person in the room, but about having the best and most robust toolkit of mental models and the discipline to use them."
              }
            ]
          },
          "richard-thaler": {
            "display_order": 30,
            "name": "Richard Thaler: The Father of 'Nudge'",
            "display_name": "Thaler",
            "introduction": "If Kahneman and Tversky were the scientists who discovered the principles of behavioral economics, Richard Thaler was the brilliant engineer and evangelist who applied them to the real world. A Nobel laureate and co-author of the blockbuster book *Nudge*, Thaler showed how understanding our predictable irrationality could help us design better systems, policies, and choices for ourselves and society.",
            "paragraphs": [
              {
                "heading": "The Birth of 'Nudge'",
                "content": "Thaler's most famous concept is the 'nudge.' A nudge is a small, low-cost intervention that subtly guides people toward a better decision without restricting their freedom of choice. As he and co-author Cass Sunstein put it, a nudge is any aspect of the choice architecture that alters people's behavior in a predictable way without forbidding any options. Putting fruit at eye level in a cafeteria is a nudge; banning junk food is not. It's about <strong>making the good choice the easy choice</strong>."
              },
              {
                "heading": "Choice Architecture",
                "content": "Thaler's work is built on the insight that the way choices are presented is never neutral. Someone, somewhere, is designing the context in which we choose—they are a 'choice architect.' The layout of a store, the design of a form, the default settings on a software program—all of these are examples of choice architecture. Since there is no neutral design, Thaler argues we have a responsibility to design systems that nudge people toward outcomes that will make their lives better."
              },
              {
                "heading": "Save More Tomorrow™",
                "content": "Thaler's most impactful real-world application is the Save More Tomorrow™ program, designed to help people save for retirement. The program cleverly uses cognitive biases for good. Instead of asking people to save more now (which feels like a loss), it asks them to commit to increasing their savings rate in the future, typically whenever they get a pay raise. This plan leverages inertia and loss aversion, as people are less likely to opt out once enrolled and are less sensitive to a loss of future, unearned income. The program has dramatically increased savings rates for millions of people."
              },
              {
                "heading": "From Theory to Policy",
                "content": "Thaler's ideas have had a profound impact on government policy. He was instrumental in the creation of the UK's Behavioural Insights Team, often called the 'Nudge Unit,' which uses behavioral science to improve public services. Dozens of governments around the world, including the United States, now have similar units that use nudges to increase tax compliance, encourage organ donation, and promote healthier lifestyles. Thaler showed that small, psychologically informed changes could have a massive and positive impact."
              },
              {
                "heading": "Humanizing Economics",
                "content": "Richard Thaler's ultimate legacy is his role in making economics more human. He challenged the field's reliance on abstract models of perfectly rational 'Econs' and instead focused on how real, flawed 'Humans' actually behave. By collecting a long list of anomalies—real-world behaviors that defied traditional economic theory—and providing psychologically grounded explanations for them, he built the bridge from the laboratory to the real world, showing that understanding our biases is the first step toward building a smarter and more compassionate society."
              }
            ]
          },
          "nassim-nicholas-taleb": {
            "display_order": 40,
            "name": "Nassim Nicholas Taleb: The Philosopher of Randomness",
            "display_name": "Taleb",
            "introduction": "Nassim Nicholas Taleb is a former options trader turned philosophical essayist whose work is a thunderous critique of our predictive hubris in a world dominated by randomness. Through concepts like the 'Black Swan' and 'Antifragility,' Taleb argues that our modern tools of risk management are dangerously naive and that we must learn to embrace uncertainty rather than trying to predict it.",
            "paragraphs": [
              {
                "heading": "The Black Swan",
                "content": "Taleb's most famous idea is the Black Swan: a rare, high-impact event that is unpredictable in prospect but seems obvious and explainable in retrospect. Examples include the rise of the internet, the 9/11 attacks, and the 2008 financial crisis. Taleb argues that history is driven not by the predictable, but by these massive, unforeseen events. Our statistical models, built on the bell curve of past data, are blind to them, giving us a dangerous illusion of control and understanding."
              },
              {
                "heading": "Mediocristan vs. Extremistan",
                "content": "To explain this, Taleb divides the world into two domains. <strong>Mediocristan</strong> is where randomness is tame and follows the bell curve. Things like human height or weight live here; no single observation can dramatically affect the average. <strong>Extremistan</strong> is where randomness is wild and unequal. Things like wealth, book sales, or market crashes live here; a single observation (a billionaire, a Harry Potter) can dominate the total. Taleb argues that we mistakenly apply the models of Mediocristan to the realities of Extremistan."
              },
              {
                "heading": "Antifragility",
                "content": "Perhaps his most original concept is Antifragility. He argues that the opposite of 'fragile' is not 'robust' or 'resilient' (which merely resist shocks), but 'antifragile.' An antifragile system is one that <strong>gains from disorder</strong>, volatility, randomness, and stress. The human immune system is antifragile; it gets stronger when exposed to germs. The restaurant industry is antifragile; individual restaurants are fragile, but the industry as a whole improves as weak players fail. He urges us to design systems that benefit from uncertainty rather than being destroyed by it."
              },
              {
                "heading": "Skin in the Game",
                "content": "Taleb's core ethical principle is 'skin in the game.' He argues that people who make decisions should bear the positive and negative consequences of those decisions. He believes many of our modern problems, from financial crises to disastrous foreign policy, are caused by a class of decision-makers who get the upside if they are right but are insulated from the downside if they are wrong. You should never fully trust a forecast from someone who pays no price for being incorrect."
              },
              {
                "heading": "A Philosophy of Uncertainty",
                "content": "Taleb's collective work offers a practical and philosophical toolkit for how to live and make decisions in a world we fundamentally do not understand. It is a powerful call for intellectual humility, a rejection of the forecasts of so-called experts, and a preference for strategies that are robust to Black Swan events. It is a guide to thriving not in spite of uncertainty, but because of it."
              }
            ]
          }
        }
      }
    }
  </script>

  <div class="fixed top-4 right-4 z-50">
    <button id="settings-btn" class="p-2 rounded-full" aria-label="toggle settings">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
    </button>
  </div>

  <div id="settings-modal" class="modal-overlay">
    <div class="modal-content">
        <button id="close-modal-btn" class="close-btn">×</button>
        <h3>Display Settings</h3>
        <label for="theme-select">Theme:</label>
        <select id="theme-select"></select>
    </div>
  </div>

  <main id="app-container" class="prose dark:prose-invert mx-auto max-w-prose p-8"></main>

  <script>
    /* ---------- state ---------- */
    let masterLibrary=null,sortedLibraryIds=null,currentLibraryId=null
    let libraryData=null,sortedTopicIds=null,currentTopicId=null,currentArticleId=null
    const app=document.getElementById('app-container')

    /* ---------- helpers ---------- */
    const looksLikeTopic=o=>o&&typeof o==='object'&&('categories'in o||'title'in o)

    /* ---------- rendering ---------- */
    const buildLibrarySwitch=()=>!sortedLibraryIds||sortedLibraryIds.length<2?'':`
      <div class="nav-container">
        <select id="library-switcher" class="nav-button">
          ${sortedLibraryIds.map(id=>{
            const label=id.replace(/-/g,' ').replace(/\b\w/g,c=>c.toUpperCase())
            return `<option value="${id}" ${id===currentLibraryId?'selected':''}>${label}</option>`
          }).join('')}
        </select>
      </div>`

    const buildTopicSwitch=()=>!sortedTopicIds||sortedTopicIds.length<2?'':`
      <div class="nav-container">
        <select id="topic-switcher" class="nav-button">
          ${sortedTopicIds.map(tid=>{
            const t=libraryData[tid];return `<option value="${tid}" ${tid===currentTopicId?'selected':''}>${t.title}</option>`
          }).join('')}
        </select>
      </div>`

    const buildNav=(cats,keys)=>{
      let html='<div class="nav-container"><div class="nav-buttons-wrapper">'
      keys.forEach(k=>{
        const a=cats[k]
        html+=`<button class="nav-button article-btn ${k===currentArticleId?'active':''}" data-article-id="${k}">${a.display_name}</button>`
        if(a.breakAfter)html+='<div class="flex-break"></div>'
      })
      return html+'</div></div>'
    }

    function render(){
      if(!libraryData)return
      
      if(masterLibrary){
          sortedTopicIds = Object.keys(libraryData).sort((a, b) => (libraryData[a].display_order || 0) - (libraryData[b].display_order || 0));
      } else {
          sortedTopicIds = Object.keys(libraryData).sort((a,b)=>(libraryData[a].display_order||0)-(libraryData[b].display_order||0));
      }

      if(!currentTopicId||!libraryData[currentTopicId])currentTopicId=sortedTopicIds[0]
      const topic=libraryData[currentTopicId]
      const artKeys=Object.keys(topic.categories||{}).sort((a,b)=>(topic.categories[a].display_order||0)-(topic.categories[b].display_order||0))
      if(!currentArticleId||!topic.categories[currentArticleId])currentArticleId=artKeys[0]
      const art=topic.categories[currentArticleId]

      app.innerHTML=buildLibrarySwitch()+`<h1>${topic.title}</h1>`+buildTopicSwitch()+buildNav(topic.categories,artKeys)+
        `<h2>${art.name||art.display_name||''}</h2>${art.introduction?`<p>${art.introduction}</p>`:''}`+
        (art.paragraphs||[]).map(p=>`<h3>${p.heading}</h3><div>${p.content}</div>`).join('')
      document.title=topic.title||'Colorful Reader'

      document.querySelectorAll('.article-btn').forEach(btn=>btn.onclick=e=>{
        currentArticleId=e.target.dataset.articleId;
        window.scrollTo({ top: 0, behavior: 'smooth' });
        setTimeout(render, 150);
      })
      const ts=document.getElementById('topic-switcher')
      if(ts)ts.onchange=e=>{currentTopicId=e.target.value;currentArticleId=null;render()}
      const ls=document.getElementById('library-switcher')
      if(ls)ls.onchange=e=>{
        currentLibraryId=e.target.value
        localStorage.setItem('readerLibraryId',currentLibraryId)
        libraryData=masterLibrary[currentLibraryId];currentTopicId=currentArticleId=null;render()
      }
      
      const themeName = localStorage.getItem('theme') || 'newspaper';
      applyThemeClasses(themeName);
    }

    /* ---------- data load ---------- */
    async function init(){
      let raw=null
      try{
        const res=await fetch('./data/content.json',{cache:'no-store'})
        if(!res.ok)throw new Error('not ok');raw=await res.json()
      }catch{
        const embedded=document.getElementById('embedded-content').textContent.trim()
        if(!embedded)throw new Error('no data');raw=JSON.parse(embedded)
      }

      const keys=Object.keys(raw)
      if(!keys.length)throw new Error('empty data')
      if(looksLikeTopic(raw[keys[0]])){
        masterLibrary=null;sortedLibraryIds=null;currentLibraryId=null
        libraryData=raw
      }else{
        masterLibrary=raw
        sortedLibraryIds=Object.keys(masterLibrary).sort((a, b) => (masterLibrary[a].display_order || 0) - (masterLibrary[b].display_order || 0));
        currentLibraryId=localStorage.getItem('readerLibraryId')
        if(!currentLibraryId||!masterLibrary[currentLibraryId])currentLibraryId=sortedLibraryIds[0]
        libraryData=masterLibrary[currentLibraryId]
      }
      currentTopicId=currentArticleId=null
      render()
    }


    /* ---------- FINAL THEME ENGINE --- */
    const THEMES = {
      'newspaper': { name: 'Newspaper', type: 'classic', isDark: false },
      'dark': { name: 'Dark', type: 'classic', isDark: true },
      'cyber-blue': {
        name: 'Cyber Blue', type: 'variable', isDark: true,
        vars: {
          '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
          '--text': '#ecf0f1', '--accent-text': '#a8b8d0',
          '--nav-bg': '#34495e', '--nav-border': '#4a4a4a', '--nav-text': '#ecf0f1',
          '--nav-hover-bg': '#4a6078', '--nav-active-bg': '#2e2e5e', '--nav-active-text': '#ecf0f1'
        },
        hover_style: 'btn-light-text'
      },
      'teal-matrix': {
        name: 'Teal Matrix', type: 'variable', isDark: true,
        vars: {
          '--bg-gradient': 'linear-gradient(135deg,#07201b 0%,#0d2f27 45%,#135348 100%)',
          '--text': '#eaf6f3',
          '--accent-text': '#9de8d9',
          '--nav-bg': '#13433a',
          '--nav-border': '#6fb7a7',
          '--nav-text': '#eaf6f3',
          '--nav-hover-bg': '#175247',
          '--nav-active-bg': '#0a2b24',
          '--nav-active-text': '#ffffff'
        },
        hover_style: 'btn-light-text'
      }
      ,'emerald-paper': {
        name:'Emerald Paper', type:'variable', isDark:false,
        vars:{
          '--bg-gradient':'#f7fbf9',
          '--text':'#1e2b28',
          '--accent-text':'#0f7f6d',
          '--nav-bg':'#e7f3ef',
          '--nav-border':'#86c8ba',
          '--nav-text':'#1e2b28',
          '--nav-hover-bg':'#d7ece6',
          '--nav-active-bg':'#bfe3d9',
          '--nav-active-text':'#1e2b28'
        },
        hover_style:'btn-dark-text'
      },
      'scorched-gold': {
        name: 'Scorched Gold', type: 'variable', isDark: false,
        vars: {
          '--bg-gradient': '#fdfbf5',
          '--text': '#2a1d15',
          '--accent-text': '#996515',
          '--nav-bg': '#f8f4e8',
          '--nav-border': '#996515',
          '--nav-text': '#2a1d15',
          '--nav-hover-bg': '#f3cd86',
          '--nav-active-bg': '#c48b2b',
          '--nav-active-text': '#2a1d15'
        },
        hover_style: 'btn-dark-text'
      }
    };
    
    function applyThemeClasses(themeName) {
        const theme = THEMES[themeName];
        if (!theme) return;

        document.body.classList.remove('newspaper-theme', 'dark-theme', 'variable-theme', 'font-newspaper', 'font-dark-theme');
        document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('btn-light-text', 'btn-dark-text'));

        if (theme.type === 'classic') {
            document.body.classList.add(theme.isDark ? 'dark-theme' : 'newspaper-theme');
            document.body.classList.add(theme.isDark ? 'font-dark-theme' : 'font-newspaper');
        } else {
            document.body.classList.add('variable-theme');
            if (theme.hover_style) {
                document.querySelectorAll('.nav-button').forEach(button => button.classList.add(theme.hover_style));
            }
        }
    }

    function applyThemeVariables(name) {
      const theme = THEMES[name] || THEMES['newspaper'];
      
      document.documentElement.classList.toggle('dark', theme.isDark);

      if (theme.type === 'variable') {
        for (const [key, value] of Object.entries(theme.vars)) {
          document.documentElement.style.setProperty(key, value);
        }
      } else { 
        const sampleVars = THEMES['cyber-blue'].vars;
        Object.keys(sampleVars).forEach(varName => {
            document.documentElement.style.removeProperty(varName);
        });
      }
    }

    function setTheme(name) {
      if (THEMES[name]) {
        localStorage.setItem('theme', name);
        applyThemeVariables(name);
        applyThemeClasses(name);
      }
    }

    function initializeModal() {
        const modal = document.getElementById('settings-modal');
        const openBtn = document.getElementById('settings-btn');
        const closeBtn = document.getElementById('close-modal-btn');
        const themeSelect = document.getElementById('theme-select');
        
        const currentTheme = localStorage.getItem('theme') || 'newspaper';
        themeSelect.innerHTML = Object.keys(THEMES).map(key => {
            const theme = THEMES[key];
            return `<option value="${key}" ${key === currentTheme ? 'selected' : ''}>${theme.name}</option>`
        }).join('');

        openBtn.onclick = () => modal.classList.add('show');
        closeBtn.onclick = () => modal.classList.remove('show');
        modal.onclick = (event) => { if (event.target === modal) modal.classList.remove('show'); };
        themeSelect.onchange = (e) => setTheme(e.target.value);
    }

    /* ---------- boot ---------- */
    document.addEventListener('DOMContentLoaded',()=>{
      const currentTheme = localStorage.getItem('theme') || 'newspaper';
      applyThemeVariables(currentTheme);
      applyThemeClasses(currentTheme);
      
      initializeModal();
      init().catch(err=>{console.error(err);app.innerHTML='<h1>Error</h1><p>Could not load content.</p>'})
    })
  </script>
</body>
</html>
