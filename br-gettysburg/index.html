<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gettysburg Knowledge Base Explorer</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg,#2c3e50 0%,#34495e 100%);
            --accent-1: #e74c3c;
            --accent-2: #c03b2b;
            --btn-gradient: linear-gradient(45deg,#e74c3c,#c0392b);
            --accent-1-rgb: 231, 76, 60;
            --accent-warning: #ffc107;
            --accent-warning-rgb: 255, 193, 7;
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: var(--bg-gradient);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .header {
            background: rgba(0,0,0,0.3);
            padding: 2rem;
            text-align: center;
            border-bottom: 3px solid var(--accent-1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-top: 0;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, var(--accent-1), var(--accent-2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            filter: drop-shadow(0 0 15px rgba(var(--accent-1-rgb), 0.3));
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.2);
            padding: 1rem;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        /* --- FINAL BUTTON RULES START --- */

        /* Base style for ALL buttons */
        .tab-button, #settings-btn, .sector-button {
            padding: 12px 24px;
            background: var(--ui-background);
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Specific settings for the icon */
        #settings-btn {
            font-size: 1.2rem;
            padding: 10px 15px;
        }

        /* HOVER state for buttons */
        .tab-button:hover, .sector-button:hover, #settings-btn:hover {
            background: var(--btn-gradient);
            transform: translateY(-2px);
        }

        /* ACTIVE state for selected buttons */
        .tab-button.active, .sector-button.active {
            background: var(--btn-gradient);
            border-color: var(--accent-2);
            transform: translateY(-2px);
            color: var(--btn-text-active);
        }

        /* LOGIC-DRIVEN TEXT COLOR FOR HOVER AND ACTIVE STATES */
        .btn-light-text:hover, .btn-light-text.active {
             color: var(--text-primary);
        }
        .btn-dark-text:hover, .btn-dark-text.active {
             color: var(--btn-text-active);
        }
        
        /* --- FINAL BUTTON RULES END --- */

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: #2c3e50;
            padding: 2rem;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            text-align: center;
            position: relative;
            width: 90%;
            max-width: 400px;
        }

        .modal-content h3 {
            color: var(--accent-1);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .modal-content label {
            font-size: 1.1rem;
            margin-right: 10px;
        }

        #theme-select {
            background-color: var(--ui-background);
            color: var(--text-primary);
            border: 1px solid var(--accent-2);
            border-radius: 5px;
            padding: 8px;
            font-size: 1rem;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            background: none;
            border: none;
            cursor: pointer;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: var(--text-primary);
            text-decoration: none;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .section-title {
            color: var(--accent-1);
            font-size: 1.8rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-1);
        }

        .subsection {
            margin: 1.5rem 0;
        }

        .subsection h3 {
            color: var(--accent-1);
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }

        .subsection h4 {
            color: var(--accent-2);
            font-size: 1.1rem;
            margin: 1rem 0 0.5rem 0;
        }

        .sector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .sector-card {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid var(--accent-1);
            transition: transform 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .sector-card:hover {
            transform: translateY(-5px);
            background: rgba(255,255,255,0.1);
        }

        .sector-name {
            color: var(--accent-1);
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .casualties-highlight {
            background: rgba(var(--accent-warning-rgb), 0.15);
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid var(--accent-warning);
            margin: 1rem 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

           .stat-card {
            background: var(--ui-background-accent);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-1);
            display: block;
        }

        .stat-label {
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        /* --- TIMELINE STYLES START --- */
        .timeline {
            position: relative;
            padding-left: 2rem;
            margin-top: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--accent-1);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            padding-left: 2rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2.05rem;
            top: 5px;
            width: 12px;
            height: 12px;
            background: var(--accent-1);
            border-radius: 50%;
            border: 2px solid var(--ui-background);
        }

        .timeline-time {
            color: var(--accent-1);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        /* --- TIMELINE STYLES END --- */


        .search-box {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
            margin-bottom: 2rem;
        }

        .search-box::placeholder {
            color: var(--text-secondary);
        }

        .highlight {
            background: rgba(var(--accent-1-rgb), 0.3);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .interactive-map {
            background: var(--container-background-subtle);
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .sector-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .sector-detail {
            display: none;
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .sector-detail.show {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            .nav-tabs {
                flex-direction: column;
                align-items: center;
            }
            .container {
                padding: 1rem;
            }
            .sector-grid {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <script>
    // Self-executing function to manage all theme logic.
    (function() {
        const DEFAULT_THEME_NAME = 'cyber-blue';
    
        let THEMES = {
            'cyber-blue': {
                '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
                '--accent-1': '#a8b8d0', '--accent-1-rgb': '168, 184, 208',
                '--accent-2': '#8899b3',
                '--btn-gradient': 'linear-gradient(45deg,#1a1a3a,#2e2e5e)',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--ui-background': '#34495e',
                '--ui-background-accent': 'rgba(52, 73, 94, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--btn-text-active': '#ecf0f1'
            },
            'teal-matrix': {
                '--bg-gradient': 'linear-gradient(135deg,#0a231c 0%,#1a3a31 50%,#2e5e50 100%)',
                '--accent-1': '#ace0d5', '--accent-1-rgb': '172, 224, 213',
                '--accent-2': '#92b3a9',
                '--btn-gradient': 'linear-gradient(45deg,#1a3a31,#2e5e50)',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--ui-background': '#345e55',
                '--ui-background-accent': 'rgba(52, 94, 85, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--btn-text-active': '#ecf0f1'
            },
            'red-alert': {
                '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
                '--ui-background': '#34495e',
                '--ui-background-accent': 'rgba(52, 73, 94, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--accent-1': '#e74c3c',
                '--accent-2': '#c03b2b',
                '--btn-gradient': 'linear-gradient(45deg,#e74c3c,#c0392b)',
                '--accent-1-rgb': '231, 76, 60',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--btn-text-active': '#ffffff'
            },
            'scorched-gold': {
                '--bg-gradient': 'linear-gradient(135deg,#0a231f 0%,#193a33 50%,#2e5e54 100%)',
                '--ui-background': '#345e56',
                '--ui-background-accent': 'rgba(52, 94, 86, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--accent-1': '#f0c475',
                '--accent-2': '#d4a24c',
                '--btn-gradient': 'linear-gradient(45deg,#f0c475,#d4a24c)',
                '--accent-1-rgb': '240, 196, 117',
                '--btn-text-active': '#2a1d15',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57'
            }
        };

        function finalizeThemes(themes) {
            for (const themeName in themes) {
                const theme = themes[themeName];
                const gradient = theme['--btn-gradient'];

                if (gradient.includes('#d') || gradient.includes('#e') || gradient.includes('#f')) {
                    theme.hover_style = 'btn-dark-text'; 
                } else {
                    theme.hover_style = 'btn-light-text';
                }
            }
            return themes;
        }

        THEMES = finalizeThemes(THEMES);
    
        function applyTheme(name) {
            const theme = THEMES[name];
            if (theme) {
                const root = document.documentElement;
                for (const [key, value] of Object.entries(theme)) {
                    if(key !== 'hover_style') {
                        root.style.setProperty(key, value);
                    }
                }

                const buttons = document.querySelectorAll('.tab-button, .sector-button, #settings-btn');
                buttons.forEach(button => {
                    button.classList.remove('btn-light-text', 'btn-dark-text');
                    if (theme.hover_style) {
                        button.classList.add(theme.hover_style);
                    }
                });
            }
        }
    
        window.setTheme = function(name) {
            applyTheme(name);
            localStorage.setItem('gettysburg-theme', name);
        }
    
        const availableThemeNames = Object.keys(THEMES);
        const savedTheme = localStorage.getItem('gettysburg-theme');
        let themeToLoad = DEFAULT_THEME_NAME;

        if (savedTheme && availableThemeNames.includes(savedTheme)) {
            themeToLoad = savedTheme;
        }
        
        applyTheme(themeToLoad);
    
        document.addEventListener('DOMContentLoaded', () => {
            const themeSelect = document.getElementById('theme-select');
            if (themeSelect) {
                themeSelect.innerHTML = '';
                availableThemeNames.forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                    themeSelect.appendChild(option);
                });
                themeSelect.value = themeToLoad;
            }
        });
    })();
    </script>
</head>
<body>
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="close-modal-btn" class="close-btn">&times;</button>
            <h3>Display Settings</h3>
            <label for="theme-select">Theme:</label>
            <select id="theme-select" onchange="setTheme(this.value)"></select>
        </div>
    </div>

    <div class="header">
        <h1>The Battle of Gettysburg</h1>
        <p>July 1–3, 1863 • The High Water Mark of the Confederacy • Knowledge Base Explorer</p>
    </div>

    <div class="nav-tabs">
        <button class="tab-button active" data-tab="overview">Overview</button>
        <button class="tab-button" data-tab="prelude">Prelude & Armies</button>
        <button class="tab-button" data-tab="day1">Day 1: A Meeting Engagement</button>
        <button class="tab-button" data-tab="day2">Day 2: The Bloody Flanks</button>
        <button class="tab-button" data-tab="day3">Day 3: Pickett's Charge</button>
        <button class="tab-button" data-tab="losses">Losses & Aftermath</button>
        <button class="tab-button" data-tab="search">Search Knowledge</button>
        <button id="settings-btn" title="Settings">⚙️</button>
    </div>

    <div class="container">
        <div id="overview" class="tab-content active">
             <div class="section-card">
                <h2 class="section-title">Gettysburg: The Turning Point</h2>
                <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                    Fought over three hot summer days in July 1863, the Battle of Gettysburg was the largest and bloodiest battle of the American Civil War. General Robert E. Lee's second invasion of the North culminated in a climactic engagement with the Union Army of the Potomac, led by the newly appointed Major General George Meade. The Confederate defeat ended Lee's hopes of a decisive victory on Northern soil and is widely considered the war's turning point.
                </p>

                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">~94,000</span>
                        <div class="stat-label">Union Army Strength</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">~72,000</span>
                        <div class="stat-label">Confederate Army Strength</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">3</span>
                        <div class="stat-label">Days of Battle</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">~51,000</span>
                        <div class="stat-label">Total Casualties (Both Sides)</div>
                    </div>
                </div>

                <div class="interactive-map">
                    <h3 style="color: var(--accent-1); margin-bottom: 1rem;">Key Sectors of the Battlefield</h3>
                    <p>Click on each sector to learn more about the specific engagements:</p>
                    <div class="sector-buttons">
                        <button class="sector-button" data-sector="lrt">Little Round Top</button>
                        <button class="sector-button" data-sector="culps">Culp's Hill</button>
                        <button class="sector-button" data-sector="wheatfield">The Wheatfield</button>
                        <button class="sector-button" data-sector="charge">Pickett's Charge</button>
                    </div>

                    <div id="lrt-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">Little Round Top</h4>
                        <p><strong>Key Units:</strong> 20th Maine, 15th Alabama</p>
                        <p><strong>Significance:</strong> The extreme left flank of the Union line. A desperate defense by Col. Joshua Chamberlain's 20th Maine, culminating in a bayonet charge, saved the Union army from being flanked on Day 2.</p>
                    </div>
                    <div id="culps-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">Culp's Hill</h4>
                        <p><strong>Key Units:</strong> Union XII Corps, Confederate Second Corps</p>
                        <p><strong>Significance:</strong> The "barb" of the Union fishhook defensive line. Fierce fighting raged here for two days as Confederates made repeated, unsuccessful attempts to seize the vital high ground.</p>
                    </div>
                    <div id="wheatfield-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">The Wheatfield</h4>
                        <p><strong>Key Units:</strong> Union III Corps, Confederate First Corps</p>
                        <p><strong>Significance:</strong> An area of intense, chaotic fighting on Day 2. Control of the field changed hands multiple times in a few hours, resulting in horrific casualties and earning it the name "the bloody wheatfield."</p>
                    </div>
                    <div id="charge-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">Pickett's Charge</h4>
                        <p><strong>Key Units:</strong> Pickett's, Pettigrew's, & Trimble's Divisions</p>
                        <p><strong>Significance:</strong> The climactic Confederate assault on the Union center on Day 3. The charge was a catastrophic failure, marking the "High Water Mark of the Confederacy."</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="prelude" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">The Gettysburg Campaign</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <h3 class="sector-name">Lee's Objective</h3>
                        <p>Following his stunning victory at Chancellorsville, Gen. Robert E. Lee decided to invade the North for a second time. His goals were to take the war out of Virginia, supply his army from the rich Pennsylvania countryside, and win a decisive victory that might force the Union to negotiate for peace.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">The Commanders</h3>
                        <p><strong>Union (Army of the Potomac):</strong> Maj. Gen. George G. Meade</p>
                        <p><strong>Confederate (Army of N. Virginia):</strong> Gen. Robert E. Lee</p>
                        <p><strong>Confederate Second-in-Command:</strong> Lt. Gen. James Longstreet</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">A Change in Command</h3>
                        <p>Just three days before the battle, President Lincoln lost confidence in Maj. Gen. Joseph Hooker and replaced him as commander of the Army of the Potomac with Maj. Gen. George Meade. Meade was forced to rush into the war's biggest battle with little time to prepare.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="day1" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Day 1: July 1, 1863</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <div class="sector-name">A Meeting Engagement</div>
                        <p>The battle began as a skirmish over a shoe supply (a myth) when Confederate infantry encountered Union cavalry under Gen. John Buford west of town. Buford recognized the importance of the high ground and fought a brilliant delaying action.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">The Iron Brigade</div>
                        <p>The Union's elite "Iron Brigade" arrived to reinforce Buford, and fierce fighting erupted on McPherson's Ridge. Union Maj. Gen. John Reynolds, one of the army's best commanders, was killed early in the fighting.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">Union Line Collapses</div>
                        <p>Outnumbered and hit on their flank by newly arriving Confederate corps, the Union line north and west of town collapsed. Union forces retreated in disarray through the streets of Gettysburg to reform on the high ground of Cemetery Hill and Culp's Hill.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="day2" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Day 2: July 2, 1863</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <div class="sector-name">The Fishhook</div>
                        <p>The Union army formed a strong defensive position resembling a fishhook, anchored on Culp's Hill to the right, running along Cemetery Ridge, and ending at the Round Tops on the left.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">Sickles' Blunder</div>
                        <p>Against orders, Union Maj. Gen. Daniel Sickles advanced his III Corps off of Cemetery Ridge to occupy higher ground near the Emmitsburg Road, creating a salient that was vulnerable to attack from multiple sides.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">Assault on the Flanks</div>
                        <p>Lee ordered Gen. Longstreet to attack the Union left flank. This led to some of the battle's most famous and brutal fighting in places like Devil's Den, the Wheatfield, the Peach Orchard, and Little Round Top.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">The Defense of Little Round Top</div>
                        <p>The 20th Maine, led by Col. Joshua Chamberlain, held the extreme left of the Union line. After repelling multiple assaults and running low on ammunition, they fixed bayonets and charged, saving the flank.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="day3" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Day 3: July 3, 1863</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <h3 class="sector-name">The Artillery Barrage</h3>
                        <p>Around 1:00 PM, the Confederates began the largest artillery bombardment of the war, with over 150 cannons firing on the Union center on Cemetery Ridge in preparation for the main assault.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">Pickett's Charge</h3>
                        <p>At roughly 3:00 PM, some 12,500 Confederate soldiers began a mile-long advance across open fields toward the Union line. The assault was a catastrophic failure, with the Confederates suffering over 50% casualties.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">The High Water Mark</h3>
                        <p>A small number of Confederates under Gen. Lewis Armistead briefly breached the stone wall at the "Angle" on Cemetery Ridge before being killed or captured. This represented the closest the Confederacy ever came to victory and is known as the "High Water Mark."</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="losses" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Losses & Aftermath</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">~23,049</span>
                        <div class="stat-label">Union Casualties (K/W/M)</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">~28,063</span>
                        <div class="stat-label">Confederate Casualties (K/W/M)</div>
                    </div>
                     <div class="stat-card">
                        <span class="stat-number">5,000+</span>
                        <div class="stat-label">Horses Killed</div>
                    </div>
                </div>
                <div class="sector-grid">
                    <div class="sector-card">
                        <h3 class="sector-name">Lee's Retreat</h3>
                        <p>On July 4, in a driving rain, Lee began his sorrowful retreat back to Virginia. Meade's army, itself badly damaged, was slow to pursue, a decision for which he was later criticized.</p>
                    </div>
                     <div class="sector-card">
                        <h3 class="sector-name">The Gettysburg Address</h3>
                         <p>Four months later, on November 19, 1863, President Abraham Lincoln delivered his famous Gettysburg Address at the dedication of the Soldiers' National Cemetery, redefining the purpose of the war.</p>
                    </div>
                     <div class="sector-card">
                        <h3 class="sector-name">The Turning Point</h3>
                         <p>Coupled with the Union victory at Vicksburg on July 4, the defeat at Gettysburg marked a strategic turning point. The Confederate army would never again have the strength to mount a major offensive on Union soil.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="search" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Search the Knowledge Base</h2>
                <input type="text" id="searchInput" class="search-box" placeholder="Search for people, places, units, or any topic...">
                
                <div id="searchResults">
                    <p style="text-align: center; color: var(--text-secondary); font-style: italic; margin: 2rem 0;">
                        Enter a search term above to explore the Gettysburg knowledge base.<br>
                        Try searching for: "Lee", "Meade", "Chamberlain", "Pickett's Charge", "20th Maine", etc.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Knowledge base for searching
        const knowledgeBase = {
            "Lee": "General Robert E. Lee, commander of the Confederate Army of Northern Virginia. Gettysburg was his greatest defeat.",
            "Meade": "Major General George G. Meade, who took command of the Union Army of the Potomac just three days before the battle and led it to victory.",
            "Longstreet": "Lieutenant General James Longstreet, Lee's senior subordinate commander. He disagreed with Lee's tactics on Day 2 and 3, arguing for a defensive battle, but his advice was overruled.",
            "Hancock": "Major General Winfield Scott Hancock, a Union corps commander who was instrumental in rallying Union troops on Day 1 and organizing the defense on Cemetery Ridge. He was severely wounded during Pickett's Charge.",
            "Reynolds": "Major General John F. Reynolds, commander of the Union I Corps. One of the most respected generals in the army, he was killed shortly after arriving on the battlefield on Day 1.",
            "Chamberlain": "Colonel Joshua Lawrence Chamberlain, commander of the 20th Maine regiment. His heroic defense of Little Round Top on Day 2 is one of the most famous actions of the Civil War.",
            "Armistead": "Confederate Brigadier General Lewis A. Armistead, who led his brigade to the 'High Water Mark' during Pickett's Charge before being mortally wounded.",
            "Buford": "Brigadier General John Buford, commander of the Union cavalry division that initiated the battle on Day 1. His decision to stand and fight bought crucial time for the Union army to occupy the high ground.",
            "Pickett's Charge": "The climactic Confederate infantry assault on the Union center on Day 3. The charge's failure marked the end of the battle and the high point of the Confederacy.",
            "Little Round Top": "A key hill on the extreme left of the Union line. Its successful defense on Day 2 prevented the Confederates from flanking the entire Union army.",
            "Culp's Hill": "The anchor of the Union right flank. It was the scene of intense fighting on Day 2 and Day 3 as Confederates tried unsuccessfully to capture it.",
            "The Iron Brigade": "An elite Union brigade known for its distinctive black hats. It saw fierce action on Day 1 and suffered devastating casualties.",
            "20th Maine": "The Union regiment commanded by Col. Joshua Chamberlain that famously defended Little Round Top with a bayonet charge.",
            "High Water Mark": "The point on Cemetery Ridge where a handful of Confederates under Gen. Armistead briefly breached the Union line during Pickett's Charge. It symbolizes the furthest advance of the Confederacy."
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeSectorButtons();
            initializeSearch();
            initializeModal();
        });

        function initializeModal() {
            const modal = document.getElementById('settings-modal');
            const openBtn = document.getElementById('settings-btn');
            const closeBtn = document.getElementById('close-modal-btn');

            if (modal && openBtn && closeBtn) {
                openBtn.addEventListener('click', () => {
                    modal.classList.add('show');
                });

                closeBtn.addEventListener('click', () => {
                    modal.classList.remove('show');
                });

                modal.addEventListener('click', (event) => {
                    if (event.target === modal) {
                        modal.classList.remove('show');
                    }
                });
            }
        }

        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
        }

        function showTab(tabName) {
            try {
                const tabContents = document.querySelectorAll('.tab-content');
                tabContents.forEach(content => {
                    if (content && content.classList) {
                        content.classList.remove('active');
                    }
                });

                const tabButtons = document.querySelectorAll('.tab-button');
                tabButtons.forEach(button => {
                    if (button && button.classList) {
                        button.classList.remove('active');
                    }
                });

                const targetTab = document.getElementById(tabName);
                if (targetTab && targetTab.classList) {
                    targetTab.classList.add('active');
                }

                const activeButton = document.querySelector(`[data-tab="${tabName}"]`);
                if (activeButton && activeButton.classList) {
                    activeButton.classList.add('active');
                }
            } catch (error) {
                console.error('Error in showTab:', error);
            }
        }

        function initializeSectorButtons() {
            const sectorButtons = document.querySelectorAll('.sector-button');
            sectorButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const sectorName = this.getAttribute('data-sector');
                    showSectorDetail(sectorName, this);
                });
            });
        }

        function showSectorDetail(sector, clickedButton) {
            try {
                const details = document.querySelectorAll('.sector-detail');
                details.forEach(detail => detail.classList.remove('show'));

                const buttons = document.querySelectorAll('.sector-button');
                buttons.forEach(button => button.classList.remove('active'));

                const targetDetail = document.getElementById(sector + '-detail');
                if (targetDetail) {
                    targetDetail.classList.add('show');
                    clickedButton.classList.add('active');
                }
            } catch (error) {
                console.error('Error in showSectorDetail:', error);
            }
        }

        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keyup', searchContent);
            }
        }

        function searchContent() {
            try {
                const searchInput = document.getElementById('searchInput');
                const resultsDiv = document.getElementById('searchResults');
                
                if (!searchInput || !resultsDiv) return;
                
                const searchTerm = searchInput.value.toLowerCase();

                if (searchTerm.length < 2) {
                    resultsDiv.innerHTML = '<p style="text-align: center; color: var(--text-secondary); font-style: italic; margin: 2rem 0;">Enter a search term above to explore the Gettysburg knowledge base.<br>Try searching for: "Lee", "Meade", "Chamberlain", "Pickett\'s Charge", "20th Maine", etc.</p>';
                    return;
                }

                let results = [];
                
                for (const key in knowledgeBase) {
                    if (knowledgeBase.hasOwnProperty(key)) {
                        const value = knowledgeBase[key];
                        if (key.toLowerCase().includes(searchTerm) || value.toLowerCase().includes(searchTerm)) {
                            results.push({
                                title: key,
                                content: value,
                                relevance: key.toLowerCase().startsWith(searchTerm) ? 2 : 1
                            });
                        }
                    }
                }

                results.sort((a, b) => b.relevance - a.relevance);

                if (results.length === 0) {
                    resultsDiv.innerHTML = `<div class="section-card"><h3 style="color: var(--accent-1);">No results found for "${searchInput.value}"</h3><p>Try searching for commander names, key locations, units, or tactics.</p></div>`;
                    return;
                }

                let resultHTML = `<h3 style="color: var(--accent-1); margin-bottom: 1.5rem;">Search Results for "${searchInput.value}"</h3>`;
                
                for (let i = 0; i < results.length; i++) {
                    const result = results[i];
                    const highlightedContent = result.content.replace(new RegExp(searchTerm, 'gi'), '<span class="highlight">$&</span>');
                    
                    resultHTML += `<div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid var(--accent-1);"><h4 style="color: var(--accent-1); margin-bottom: 0.8rem;">${result.title}</h4><p style="line-height: 1.6;">${highlightedContent}</p></div>`;
                }

                resultsDiv.innerHTML = resultHTML;
            } catch (error) {
                console.error('Error in searchContent:', error);
            }
        }
    </script>
</body>
</html>
