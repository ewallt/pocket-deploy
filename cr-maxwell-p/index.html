<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Colorful Reader</title>

  <!-- Tailwind + typography -->
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>

  <!-- Optional BLB tagger (safe to leave in) -->
  <script src="https://www.blueletterbible.org/scripts/blbToolTip/BLB_ScriptTagger-min.js"></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">

  <style>
    /* Typography */
    .font-newspaper{font-family:'Lora',serif}
    .font-dark-theme{font-family:'Lora',serif}
    body{transition:background .3s,color .3s}
    .prose h1{min-height:7.5rem}

    /* --- Classic Themes (Original) --- */
    .newspaper-theme{background:#fdfdfd;color:#1a1a1a}
    .newspaper-theme .nav-button{background:#f8f9fa;border:1px solid #dee2e6;color:#212529}
    .newspaper-theme .nav-button:hover{background:#e9ecef}
    .newspaper-theme .nav-button.active{background:#1a1a1a;color:#fdfdfd}

    .dark-theme{background:#2d2d30;color:#fff}
    .dark-theme .nav-button{background:#3c3c3c;border:1px solid #4a4a4a;color:#ccc}
    .dark-theme .nav-button:hover{background:#4a4a4a}
    .dark-theme .nav-button.active{background:#fff;color:#2d2d30}

.nav-button:focus-visible{outline:2px solid var(--nav-border);outline-offset:2px}
.variable-theme .prose a{color:var(--accent-text);text-underline-offset:2px}

    
    /* --- New Variable-Based Theme Engine --- */
    :root {
        --bg-gradient: #fdfdfd;
        --text: #1a1a1a;
        --accent-text: #1a1a1a;
        --nav-bg: #f8f9fa;
        --nav-border: #dee2e6;
        --nav-text: #212529;
        --nav-hover-bg: #e9ecef;
        --nav-active-bg: #1a1a1a;
        --nav-active-text: #fdfdfd;
    }
    
    .variable-theme {
        background: var(--bg-gradient);
        color: var(--text);
        font-family: 'Lora', serif;
    }
    .variable-theme .prose h1,
    .variable-theme .prose h2,
    .variable-theme .prose h3 {
        color: var(--accent-text);
    }
    .variable-theme .nav-button {
        background-color: var(--nav-bg);
        border: 1px solid var(--nav-border);
        color: var(--nav-text);
    }
    .variable-theme .nav-button:hover {
        background-color: var(--nav-hover-bg);
    }
    .variable-theme .nav-button.active {
        background-color: var(--nav-active-bg);
        color: var(--nav-active-text);
    }
    .variable-theme .nav-button.btn-dark-text.active,
    .variable-theme .nav-button.btn-dark-text:hover {
        color: var(--nav-active-text);
    }
    .variable-theme .nav-button.btn-light-text.active,
    .variable-theme .nav-button.btn-light-text:hover {
        color: var(--nav-active-text);
    }

    /* --- Shared & Modal Styles --- */
    .nav-container{margin-bottom:2rem}
    .nav-button{padding:.5rem 1rem;margin:.5rem .5rem .5rem 0;border-radius:.375rem;transition:all .2s;cursor:pointer}
    #library-switcher,#topic-switcher{padding:.5rem;border-radius:.375rem;margin-bottom:1rem;width:100%;border:1px solid #ccc}
    .nav-buttons-wrapper{display:flex;flex-wrap:wrap;align-items:center;width:100%}
    .flex-break{flex-basis:100%;height:0}

    .modal-overlay {
        display: none; position: fixed; z-index: 1000; left: 0; top: 0;
        width: 100%; height: 100%;
        background-color: rgba(0,0,0,0.6);
        justify-content: center; align-items: center;
    }
    .modal-overlay.show { display: flex; }
    .modal-content {
        background: #fff; color: #2d2d30; padding: 2rem; border-radius: 8px;
        text-align: center; position: relative; width: 90%; max-width: 400px;
    }
    .dark .modal-content { background: #2d2d30; color: #fff; }
    .modal-content h3 { font-size: 1.5rem; margin-bottom: 1.5rem; }
    .modal-content label { font-size: 1.1rem; margin-right: 10px; }
    #theme-select {
        background-color: #f0f0f0; color: #2d2d30;
        border: 1px solid #ccc; border-radius: 5px; padding: 8px; font-size: 1rem;
    }
    .dark #theme-select {
        background-color: #3c3c3c; color: #fff; border-color: #4a4a4a;
    }
    .close-btn {
        position: absolute; top: 10px; right: 15px; color: #aaa;
        font-size: 28px; font-weight: bold; background: none;
        border: none; cursor: pointer;
    }
  </style>
</head>
<body class="font-newspaper newspaper-theme">

  <script id="embedded-content" type="application/json">
  {
    "the-berlin-wall": {
      "title": "The Berlin Wall",
      "description": "A concise history of the Berlin Wall, covering its origins in post-war tensions, its construction and structure, life in the divided city, notable escape attempts, and its eventual fall and lasting legacy.",
      "categories": {
        "origins": {
          "display_order": 10,
          "name": "origins_and_political_context",
          "display_name": "Origins & Political Context",
          "introduction": "Explore the post-WWII tensions that led to the division of Germany and Berlin, creating the conditions for the wall's construction. This section covers the ideological clash and the refugee crisis that precipitated the drastic measures taken by East Germany.",
          "paragraphs": [
            {
              "heading": "Post-War Division of Germany",
              "content": "<p>After World War II, Germany and its capital, Berlin, were divided into four occupation zones controlled by the Allied powers: the United States, the United Kingdom, France, and the Soviet Union. As Cold War tensions grew, the Western-controlled zones merged to form West Germany (the Federal Republic of Germany), while the Soviet zone became East Germany (the German Democratic Republic, or GDR). Berlin, located deep inside East Germany, remained similarly divided, creating a capitalist Western enclave in the middle of a communist state.</p>"
            },
            {
              "heading": "The Berlin Airlift",
              "content": "<p>One of the first major crises of the Cold War highlighted Berlin's vulnerability. In 1948, the Soviet Union blocked all road, rail, and canal access to West Berlin in an attempt to drive out the Western powers. In response, the Western Allies organized the Berlin Airlift, flying in food, fuel, and supplies for nearly a year. This massive operation sustained over two million West Berliners and was a huge political victory for the West, cementing the division between the two sides.</p>"
            },
            {
              "heading": "East vs. West Ideologies",
              "content": "<p>West Berlin became a vibrant symbol of Western capitalism and democratic freedoms, often referred to as a 'window to the West.' It stood in stark contrast to East Berlin, which was governed by the authoritarian, Soviet-backed communist regime of the GDR. This ideological opposition made the open border within Berlin a point of major contention, as it exposed East Germans to the prosperity and liberties of the West.</p>"
            },
            {
              "heading": "The 'Brain Drain' Crisis",
              "content": "<p>Between 1949 and 1961, an estimated 2.5 to 3 million East Germans fled to West Germany, most of them through the open border in Berlin. This mass emigration, known as 'Republikflucht' (flight from the republic), created a severe 'brain drain' as many of those leaving were young, educated professionals like doctors, engineers, and teachers. This loss of skilled labor threatened the economic stability of East Germany and was a deep embarrassment to the communist regime.</p>"
            },
            {
              "heading": "Khrushchev's Ultimatum",
              "content": "<p>Frustrated by the continuous flow of refugees, Soviet Premier Nikita Khrushchev issued an ultimatum in 1958, demanding the Western powers withdraw from Berlin and that it be declared a 'free city.' The West refused to yield, leading to several years of high-stakes diplomatic tension. With the refugee crisis worsening, the East German government, with Soviet backing, secretly prepared a drastic solution to halt the exodus once and for all.</p>"
            }
          ]
        },
        "construction": {
          "display_order": 20,
          "name": "construction_and_structure",
          "display_name": "Construction & Structure",
          "introduction": "On a single night, Berlin was divided by a physical barrier that evolved from a simple fence into a complex and deadly fortification. This section details the initial construction and the sophisticated structure of the Berlin Wall.",
          "paragraphs": [
            {
              "heading": "Operation Rose: August 13, 1961",
              "content": "<p>In the early hours of Sunday, August 13, 1961, East German soldiers and police began to tear up streets and erect barbed wire fences through the heart of Berlin. This secret operation, codenamed 'Operation Rose,' took residents completely by surprise. By morning, the border between East and West Berlin was sealed, instantly separating families, friends, and neighbors.</p>"
            },
            {
              "heading": "From Barbed Wire to Concrete",
              "content": "<p>The initial barrier of barbed wire and cinder blocks was quickly replaced by a more permanent structure. Over the years, the Wall evolved through four distinct generations. The final version, built from 1975 to 1980, consisted of reinforced concrete slabs over 11 feet high, topped with a smooth pipe to make climbing more difficult. This formidable barrier stretched for nearly 100 miles around West Berlin.</p>"
            },
            {
              "heading": "The Death Strip",
              "content": "<p>The most infamous feature of the Wall was the 'death strip,' a wide area of open ground that lay between two parallel walls on the East German side. This area was covered in sand or raked gravel to show footprints, and was equipped with anti-vehicle trenches, beds of nails ('Stalin\\'s Carpet'), and tripwire-activated machine guns. It provided a clear line of fire for the guards in the watchtowers.</p>"
            },
            {
              "heading": "Watchtowers and Guards",
              "content": "<p>Over 300 watchtowers were built along the Berlin Wall, manned by elite East German border guards. These guards were under strict orders to shoot anyone attempting to cross into West Berlin. The 'Schießbefehl' (order to fire) was a standing command that resulted in the deaths of over 100 people at the Wall.</p>"
            },
            {
              "heading": "Border Crossings and Checkpoints",
              "content": "<p>While the border was sealed, a small number of official crossings were established for diplomats, foreigners, and West Germans with special permits. The most famous of these was Checkpoint Charlie, the primary crossing point for Allied military personnel and foreigners. These checkpoints were heavily guarded and symbolized the tense standoff between East and West.</p>"
            },
            {
              "heading": "The 'Fourth-Generation' Wall (Grenzmauer 75)",
              "content": "<p>The final version of the Wall was a sophisticated, prefabricated system designed for maximum security and easy construction. It was composed of 45,000 individual concrete sections, each about 12 feet high and 4 feet wide. This modular design allowed for quick repairs and replacement, ensuring the border remained impenetrable right up until its final days.</p>"
            }
          ]
        },
        "life_in_a_divided_city": {
          "display_order": 30,
          "name": "life_in_a_divided_city",
          "display_name": "Life in a Divided City",
          "introduction": "The Berlin Wall was more than a physical barrier; it was a daily reality that profoundly affected the lives of all Berliners. This section looks at the human and societal impact of a city split in two.",
          "paragraphs": [
            {
              "heading": "Families Torn Apart",
              "content": "<p>The sudden construction of the Wall had an immediate and devastating human cost, trapping people on whichever side they happened to be on that Sunday morning. Parents were separated from children, siblings from each other, and friends were cut off for decades. Communication was limited to letters, and for many years, most East Berliners were unable to visit their relatives in the West.</p>"
            },
            {
              "heading": "Economic Divergence",
              "content": "<p>The division solidified two vastly different economic systems. West Berlin, supported by West Germany and the Allies, became a prosperous hub of commerce and culture. In contrast, East Berlin, as the capital of the GDR, operated under a state-controlled socialist economy that often struggled with shortages and a lack of consumer goods.</p>"
            },
            {
              "heading": "Western Enclave, Eastern Capital",
              "content": "<p>West Berlin became an isolated 'island of freedom' deep within East Germany, developing a unique and defiant cultural identity. East Berlin was the showcase capital of the GDR, where the state invested heavily in monumental architecture and public displays to project an image of communist success, even as its citizens faced strict controls and surveillance.</p>"
            },
            {
              "heading": "The Stasi's Surveillance",
              "content": "<p>Life in East Berlin was overshadowed by the Ministry for State Security, or Stasi, one of the most pervasive secret police forces in history. The Stasi relied on a vast network of official agents and unofficial informants to monitor citizens for any sign of dissent or disloyalty. This created a climate of fear and suspicion that permeated every aspect of society.</p>"
            },
            {
              "heading": "Cultural and Symbolic Divide",
              "content": "<p>The Wall became a powerful symbol of the Cold War's 'Iron Curtain.' Speeches by Western leaders at the Wall, like John F. Kennedy's 'Ich bin ein Berliner' speech in 1963 and Ronald Reagan's 'Tear down this wall!' speech in 1987, became iconic moments. For East Germans, the Wall was a constant, tangible reminder of their imprisonment and lack of freedom.</p>"
            },
            {
              "heading": "Western Visitors and Passes",
              "content": "<p>Over time, limited agreements allowed West Berliners to apply for short-term visas to visit relatives in the East, often requiring them to exchange a minimum amount of currency. These brief, emotional reunions at crossing points highlighted the pain of division. For East Berliners, however, travel to the West remained almost impossible for most of the Wall's existence.</p>"
            }
          ]
        },
        "escape_attempts": {
          "display_order": 40,
          "name": "escape_attempts_and_incidents",
          "display_name": "Escape Attempts & Incidents",
          "introduction": "Despite the danger, thousands of East Germans attempted to escape over, under, or through the Berlin Wall. This section recounts the ingenuity, bravery, and tragedy of these attempts to reach freedom.",
          "paragraphs": [
            {
              "heading": "Early Daring Escapes",
              "content": "<p>In the early days of the Wall, escapes were more common and often audacious. People jumped from apartment windows on the border into safety nets held by West Berlin firefighters. East German border guard Conrad Schumann famously leaped over a coil of barbed wire to freedom just two days after the border was sealed, an act captured in an iconic photograph.</p>"
            },
            {
              "heading": "Tunneling to Freedom",
              "content": "<p>As the Wall became more formidable, escape attempts grew more elaborate. Groups of students and activists in West Berlin dug several tunnels under the Wall to help people escape. The most famous of these, 'Tunnel 57,' allowed 57 people to escape in October 1964 before it was discovered.</p>"
            },
            {
              "heading": "Ingenious Methods",
              "content": "<p>Escapees displayed incredible ingenuity. Some flew over the Wall in homemade hot-air balloons or ultralight aircraft. Others built secret compartments in cars or used forged diplomatic passports. One family even zip-lined from the roof of an East Berlin building to a building in the West.</p>"
            },
            {
              "heading": "The First and Last Fatalities",
              "content": "<p>The first person killed trying to cross the Wall was Günter Litfin, who was shot by transport police while swimming across the Spree River in August 1961. The last person to be shot and killed was Chris Gueffroy in February 1989. The final fatality was Winfried Freudenberg, who died in March 1989 after his gas balloon crashed.</p>"
            },
            {
              "heading": "The Peter Fechter Incident",
              "content": "<p>One of the most infamous incidents involved 18-year-old Peter Fechter, who was shot by East German guards while trying to climb the Wall in 1962. He fell back into the death strip on the Eastern side and and was left to bleed to death in full view of Western media and onlookers, who were powerless to help. His death became a symbol of the Wall's inhumanity.</p>"
            }
          ]
        },
        "fall_and_legacy": {
          "display_order": 50,
          "name": "fall_and_legacy",
          "display_name": "Fall & Legacy",
          "introduction": "The seemingly permanent Berlin Wall fell as suddenly as it was built. This section explores the events that led to its collapse, the joyful scenes of November 9, 1989, and the enduring legacy of this Cold War symbol.",
          "paragraphs": [
            {
              "heading": "Gorbachev's Reforms and 'Sinatra Doctrine'",
              "content": "<p>The rise of Mikhail Gorbachev as the leader of the Soviet Union in the mid-1980s was a critical catalyst. His policies of 'glasnost' (openness) and 'perestroika' (restructuring) created a new political climate. Crucially, he abandoned the Brezhnev Doctrine, which had justified Soviet intervention in its satellite states, replacing it with the humorous 'Sinatra Doctrine,' allowing Warsaw Pact nations to do things 'their way.'</p>"
            },
            {
              "heading": "The Protest Movement in East Germany",
              "content": "<p>By the summer and fall of 1989, mass protests against the East German regime grew across the country, most notably the Monday demonstrations in Leipzig. Simultaneously, thousands of East Germans began fleeing through Hungary and Czechoslovakia, which had opened their borders with the West. The East German government was facing a crisis of legitimacy and immense internal pressure.</p>"
            },
            {
              "heading": "The Press Conference Mistake",
              "content": "<p>On the evening of November 9, 1989, East German government official Günter Schabowski held a routine press conference. Near the end, he was handed a note about new, relaxed travel regulations but had not been fully briefed. When asked when the new rules would take effect, he famously stammered, 'As far as I know, effective immediately, without delay.'</p>"
            },
            {
              "heading": "The Night of November 9, 1989",
              "content": "<p>Schabowski's statement was broadcast on West German television, which most East Berliners could watch. Within minutes, thousands of East Berliners flocked to the border crossings, demanding to be let through. Overwhelmed and without clear orders, the border guards at the Bornholmer Strasse crossing eventually opened the gates. In a night of euphoric celebration, Berliners from East and West crossed the border freely for the first time in 28 years, climbing the Wall and celebrating together.</p>"
            },
            {
              "heading": "German Reunification",
              "content": "<p>The fall of the Berlin Wall set in motion a rapid chain of events. It symbolized the collapse of the East German state and the end of the Cold War. Less than a year later, on October 3, 1990, Germany was officially reunified, bringing an end to more than four decades of division.</p>"
            },
            {
              "heading": "The Wall as a Memorial",
              "content": "<p>Today, very little of the original Wall remains. The longest surviving section, known as the East Side Gallery, is an open-air art gallery painted by artists from around the world. Other fragments and memorials, along with a line of cobblestones marking its former path, serve as a powerful reminder of the city's division and the global struggle for freedom.</p>"
            }
          ]
        }
      }
    }
  }
  </script>

  <div class="fixed top-4 right-4 z-50">
    <button id="settings-btn" class="p-2 rounded-full" aria-label="toggle settings">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
    </button>
  </div>

  <div id="settings-modal" class="modal-overlay">
    <div class="modal-content">
        <button id="close-modal-btn" class="close-btn">×</button>
        <h3>Display Settings</h3>
        <label for="theme-select">Theme:</label>
        <select id="theme-select"></select>
    </div>
  </div>

  <main id="app-container" class="prose dark:prose-invert mx-auto max-w-prose p-8"></main>

  <script>
    /* ---------- state ---------- */
    let masterLibrary=null,sortedLibraryIds=null,currentLibraryId=null
    let libraryData=null,sortedTopicIds=null,currentTopicId=null,currentArticleId=null
    const app=document.getElementById('app-container')

    /* ---------- helpers ---------- */
    const looksLikeTopic=o=>o&&typeof o==='object'&&('categories'in o||'title'in o)

    /* ---------- rendering ---------- */
    const buildLibrarySwitch=()=>!sortedLibraryIds||sortedLibraryIds.length<2?'':`
      <div class="nav-container">
        <select id="library-switcher" class="nav-button">
          ${sortedLibraryIds.map(id=>{
            const label=id.replace(/-/g,' ').replace(/\b\w/g,c=>c.toUpperCase())
            return `<option value="${id}" ${id===currentLibraryId?'selected':''}>${label}</option>`
          }).join('')}
        </select>
      </div>`

    const buildTopicSwitch=()=>`
      <div class="nav-container">
        <select id="topic-switcher" class="nav-button">
          ${sortedTopicIds.map(tid=>{
            const t=libraryData[tid];return `<option value="${tid}" ${tid===currentTopicId?'selected':''}>${t.title}</option>`
          }).join('')}
        </select>
      </div>`

    const buildNav=(cats,keys)=>{
      let html='<div class="nav-container"><h3>Select Article:</h3><div class="nav-buttons-wrapper">'
      keys.forEach(k=>{
        const a=cats[k]
        html+=`<button class="nav-button article-btn ${k===currentArticleId?'active':''}" data-article-id="${k}">${a.display_name}</button>`
        if(a.breakAfter)html+='<div class="flex-break"></div>'
      })
      return html+'</div></div>'
    }

    function render(){
      if(!libraryData)return
      sortedTopicIds=Object.keys(libraryData).sort((a,b)=>(libraryData[a].display_order||0)-(libraryData[b].display_order||0))
      if(!currentTopicId||!libraryData[currentTopicId])currentTopicId=sortedTopicIds[0]
      const topic=libraryData[currentTopicId]
      const artKeys=Object.keys(topic.categories||{}).sort((a,b)=>(topic.categories[a].display_order||0)-(topic.categories[b].display_order||0))
      if(!currentArticleId||!topic.categories[currentArticleId])currentArticleId=artKeys[0]
      const art=topic.categories[currentArticleId]

      app.innerHTML=buildLibrarySwitch()+`<h1>${topic.title}</h1>`+buildTopicSwitch()+buildNav(topic.categories,artKeys)+
        `<h2>${art.name||art.display_name||''}</h2>${art.introduction?`<p>${art.introduction}</p>`:''}`+
        (art.paragraphs||[]).map(p=>`<h3>${p.heading}</h3><p>${p.content}</p>`).join('')
      document.title=topic.title||'Adaptive Reader'

      document.querySelectorAll('.article-btn').forEach(btn=>btn.onclick=e=>{
        currentArticleId=e.target.dataset.articleId;render()
      })
      const ts=document.getElementById('topic-switcher')
      if(ts)ts.onchange=e=>{currentTopicId=e.target.value;currentArticleId=null;render()}
      const ls=document.getElementById('library-switcher')
      if(ls)ls.onchange=e=>{
        currentLibraryId=e.target.value
        localStorage.setItem('readerLibraryId',currentLibraryId)
        libraryData=masterLibrary[currentLibraryId];currentTopicId=currentArticleId=null;render()
      }
      
      const themeName = localStorage.getItem('theme') || 'newspaper';
      applyThemeClasses(themeName);
    }

    /* ---------- data load ---------- */
    async function init(){
      let raw=null
      try{
        const res=await fetch('./data/content.json',{cache:'no-store'})
        if(!res.ok)throw new Error('not ok');raw=await res.json()
      }catch{
        const embedded=document.getElementById('embedded-content').textContent.trim()
        if(!embedded)throw new Error('no data');raw=JSON.parse(embedded)
      }

      const keys=Object.keys(raw)
      if(!keys.length)throw new Error('empty data')
      if(looksLikeTopic(raw[keys[0]])){
        masterLibrary=null;sortedLibraryIds=null;currentLibraryId=null
        libraryData=raw
      }else{
        masterLibrary=raw
        sortedLibraryIds=keys.sort()
        currentLibraryId=localStorage.getItem('readerLibraryId')
        if(!currentLibraryId||!masterLibrary[currentLibraryId])currentLibraryId=sortedLibraryIds[0]
        libraryData=masterLibrary[currentLibraryId]
      }
      currentTopicId=currentArticleId=null
      render()
    }


    /* ---------- FINAL THEME ENGINE --- */
    const THEMES = {
      'newspaper': { name: 'Newspaper', type: 'classic', isDark: false },
      'dark': { name: 'Dark', type: 'classic', isDark: true },
      'cyber-blue': {
        name: 'Cyber Blue', type: 'variable', isDark: true,
        vars: {
          '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
          '--text': '#ecf0f1', '--accent-text': '#a8b8d0',
          '--nav-bg': '#34495e', '--nav-border': '#4a4a4a', '--nav-text': '#ecf0f1',
          '--nav-hover-bg': '#4a6078', '--nav-active-bg': '#2e2e5e', '--nav-active-text': '#ecf0f1'
        },
        hover_style: 'btn-light-text'
      },
      'teal-matrix': {
  name: 'Teal Matrix', type: 'variable', isDark: true,
  vars: {
    '--bg-gradient': 'linear-gradient(135deg,#07201b 0%,#0d2f27 45%,#135348 100%)',
    '--text': '#eaf6f3',
    '--accent-text': '#9de8d9',
    '--nav-bg': '#13433a',
    '--nav-border': '#6fb7a7',
    '--nav-text': '#eaf6f3',
    '--nav-hover-bg': '#175247',
    '--nav-active-bg': '#0a2b24',
    '--nav-active-text': '#ffffff'
  },
  hover_style: 'btn-light-text'
}
,'emerald-paper': {
  name:'Emerald Paper', type:'variable', isDark:false,
  vars:{
    '--bg-gradient':'#f7fbf9',
    '--text':'#1e2b28',
    '--accent-text':'#0f7f6d',
    '--nav-bg':'#e7f3ef',
    '--nav-border':'#86c8ba',
    '--nav-text':'#1e2b28',
    '--nav-hover-bg':'#d7ece6',
    '--nav-active-bg':'#bfe3d9',
    '--nav-active-text':'#1e2b28'
  },
  hover_style:'btn-dark-text'
},
      'scorched-gold': {
  name: 'Scorched Gold', type: 'variable', isDark: false,
  vars: {
    '--bg-gradient': '#fdfbf5',
    '--text': '#2a1d15',

    /* Deeper ochre for headings/accents (≥4.5:1 on bg) */
    '--accent-text': '#996515',

    /* Nav: clearer separation + distinct hover vs active */
    '--nav-bg': '#f8f4e8',
    '--nav-border': '#996515',   // stronger, matches accent (≈4.52:1 vs nav bg)
    '--nav-text': '#2a1d15',
    '--nav-hover-bg': '#f3cd86', // lighter than active
    '--nav-active-bg': '#c48b2b',// darker than hover
    '--nav-active-text': '#2a1d15'
  },
  hover_style: 'btn-dark-text'
}

    };
    
    function applyThemeClasses(themeName) {
        const theme = THEMES[themeName];
        if (!theme) return;

        document.body.classList.remove('newspaper-theme', 'dark-theme', 'variable-theme', 'font-newspaper', 'font-dark-theme');
        document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('btn-light-text', 'btn-dark-text'));

        if (theme.type === 'classic') {
            document.body.classList.add(theme.isDark ? 'dark-theme' : 'newspaper-theme');
            document.body.classList.add(theme.isDark ? 'font-dark-theme' : 'font-newspaper');
        } else {
            document.body.classList.add('variable-theme');
            if (theme.hover_style) {
                document.querySelectorAll('.nav-button').forEach(button => button.classList.add(theme.hover_style));
            }
        }
    }

    function applyThemeVariables(name) {
      const theme = THEMES[name] || THEMES['newspaper'];
      
      document.documentElement.classList.toggle('dark', theme.isDark);

      if (theme.type === 'variable') {
        for (const [key, value] of Object.entries(theme.vars)) {
          document.documentElement.style.setProperty(key, value);
        }
      } else { 
        const sampleVars = THEMES['cyber-blue'].vars;
        Object.keys(sampleVars).forEach(varName => {
            document.documentElement.style.removeProperty(varName);
        });
      }
    }

    function setTheme(name) {
      if (THEMES[name]) {
        localStorage.setItem('theme', name);
        applyThemeVariables(name);
        applyThemeClasses(name);
      }
    }

    function initializeModal() {
        const modal = document.getElementById('settings-modal');
        const openBtn = document.getElementById('settings-btn');
        const closeBtn = document.getElementById('close-modal-btn');
        const themeSelect = document.getElementById('theme-select');
        
        const currentTheme = localStorage.getItem('theme') || 'newspaper';
        themeSelect.innerHTML = Object.keys(THEMES).map(key => {
            const theme = THEMES[key];
            return `<option value="${key}" ${key === currentTheme ? 'selected' : ''}>${theme.name}</option>`
        }).join('');

        openBtn.onclick = () => modal.classList.add('show');
        closeBtn.onclick = () => modal.classList.remove('show');
        modal.onclick = (event) => { if (event.target === modal) modal.classList.remove('show'); };
        themeSelect.onchange = (e) => setTheme(e.target.value);
    }

    /* ---------- boot ---------- */
    document.addEventListener('DOMContentLoaded',()=>{
      const currentTheme = localStorage.getItem('theme') || 'newspaper';
      applyThemeVariables(currentTheme);
      applyThemeClasses(currentTheme);
      
      initializeModal();
      init().catch(err=>{console.error(err);app.innerHTML='<h1>Error</h1><p>Could not load content.</p>'})
    })
  </script>
</body>
</html>
