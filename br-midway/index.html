<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Midway Knowledge Base Explorer</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg,#2c3e50 0%,#34495e 100%);
            --accent-1: #e74c3c;
            --accent-2: #c03b2b;
            --btn-gradient: linear-gradient(45deg,#e74c3c,#c0392b);
            --accent-1-rgb: 231, 76, 60;
            --accent-warning: #ffc107;
            --accent-warning-rgb: 255, 193, 7;
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: var(--bg-gradient);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .header {
            background: rgba(0,0,0,0.3);
            padding: 2rem;
            text-align: center;
            border-bottom: 3px solid var(--accent-1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-top: 0;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, var(--accent-1), var(--accent-2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            filter: drop-shadow(0 0 15px rgba(var(--accent-1-rgb), 0.3));
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.2);
            padding: 1rem;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        /* --- FINAL BUTTON RULES START --- */

        /* Base style for ALL buttons */
        .tab-button, #settings-btn, .sector-button {
            padding: 12px 24px;
            background: var(--ui-background);
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Specific settings for the icon */
        #settings-btn {
            font-size: 1.2rem;
            padding: 10px 15px;
        }

        /* HOVER state for buttons */
        .tab-button:hover, .sector-button:hover, #settings-btn:hover {
            background: var(--btn-gradient);
            transform: translateY(-2px);
        }

        /* ACTIVE state for selected buttons */
        .tab-button.active, .sector-button.active {
            background: var(--btn-gradient);
            border-color: var(--accent-2);
            transform: translateY(-2px);
            color: var(--btn-text-active);
        }

        /* LOGIC-DRIVEN TEXT COLOR FOR HOVER AND ACTIVE STATES */
        .btn-light-text:hover, .btn-light-text.active {
             color: var(--text-primary);
        }
        .btn-dark-text:hover, .btn-dark-text.active {
             color: var(--btn-text-active);
        }
        
        /* --- FINAL BUTTON RULES END --- */

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: #2c3e50;
            padding: 2rem;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            text-align: center;
            position: relative;
            width: 90%;
            max-width: 400px;
        }

        .modal-content h3 {
            color: var(--accent-1);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .modal-content label {
            font-size: 1.1rem;
            margin-right: 10px;
        }

        #theme-select {
            background-color: var(--ui-background);
            color: var(--text-primary);
            border: 1px solid var(--accent-2);
            border-radius: 5px;
            padding: 8px;
            font-size: 1rem;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            background: none;
            border: none;
            cursor: pointer;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: var(--text-primary);
            text-decoration: none;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .section-title {
            color: var(--accent-1);
            font-size: 1.8rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-1);
        }

        .subsection {
            margin: 1.5rem 0;
        }

        .subsection h3 {
            color: var(--accent-1);
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }

        .subsection h4 {
            color: var(--accent-2);
            font-size: 1.1rem;
            margin: 1rem 0 0.5rem 0;
        }

        .sector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .sector-card {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid var(--accent-1);
            transition: transform 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .sector-card:hover {
            transform: translateY(-5px);
            background: rgba(255,255,255,0.1);
        }

        .sector-name {
            color: var(--accent-1);
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .casualties-highlight {
            background: rgba(var(--accent-warning-rgb), 0.15);
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid var(--accent-warning);
            margin: 1rem 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

           .stat-card {
            background: var(--ui-background-accent);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-1);
            display: block;
        }

        .stat-label {
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        /* --- TIMELINE STYLES START --- */
        .timeline {
            position: relative;
            padding-left: 2rem;
            margin-top: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--accent-1);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            padding-left: 2rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2.05rem;
            top: 5px;
            width: 12px;
            height: 12px;
            background: var(--accent-1);
            border-radius: 50%;
            border: 2px solid var(--ui-background);
        }

        .timeline-time {
            color: var(--accent-1);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        /* --- TIMELINE STYLES END --- */


        .search-box {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
            margin-bottom: 2rem;
        }

        .search-box::placeholder {
            color: var(--text-secondary);
        }

        .highlight {
            background: rgba(var(--accent-1-rgb), 0.3);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .interactive-map {
            background: var(--container-background-subtle);
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .sector-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .sector-detail {
            display: none;
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .sector-detail.show {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            .nav-tabs {
                flex-direction: column;
                align-items: center;
            }
            .container {
                padding: 1rem;
            }
            .sector-grid {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <script>
    // Self-executing function to manage all theme logic.
    (function() {
        const DEFAULT_THEME_NAME = 'cyber-blue';
    
        let THEMES = {
            'cyber-blue': {
                '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
                '--accent-1': '#a8b8d0', '--accent-1-rgb': '168, 184, 208',
                '--accent-2': '#8899b3',
                '--btn-gradient': 'linear-gradient(45deg,#1a1a3a,#2e2e5e)',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--ui-background': '#34495e',
                '--ui-background-accent': 'rgba(52, 73, 94, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--btn-text-active': '#ecf0f1'
            },
            'teal-matrix': {
                '--bg-gradient': 'linear-gradient(135deg,#0a231c 0%,#1a3a31 50%,#2e5e50 100%)',
                '--accent-1': '#ace0d5', '--accent-1-rgb': '172, 224, 213',
                '--accent-2': '#92b3a9',
                '--btn-gradient': 'linear-gradient(45deg,#1a3a31,#2e5e50)',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--ui-background': '#345e55',
                '--ui-background-accent': 'rgba(52, 94, 85, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--btn-text-active': '#ecf0f1'
            },
            'red-alert': {
                '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
                '--ui-background': '#34495e',
                '--ui-background-accent': 'rgba(52, 73, 94, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--accent-1': '#e74c3c',
                '--accent-2': '#c03b2b',
                '--btn-gradient': 'linear-gradient(45deg,#e74c3c,#c0392b)',
                '--accent-1-rgb': '231, 76, 60',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--btn-text-active': '#ffffff'
            },
            'scorched-gold': {
                '--bg-gradient': 'linear-gradient(135deg,#0a231f 0%,#193a33 50%,#2e5e54 100%)',
                '--ui-background': '#345e56',
                '--ui-background-accent': 'rgba(52, 94, 86, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--accent-1': '#f0c475',
                '--accent-2': '#d4a24c',
                '--btn-gradient': 'linear-gradient(45deg,#f0c475,#d4a24c)',
                '--accent-1-rgb': '240, 196, 117',
                '--btn-text-active': '#2a1d15',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57'
            }
        };

        function finalizeThemes(themes) {
            for (const themeName in themes) {
                const theme = themes[themeName];
                const gradient = theme['--btn-gradient'];

                if (gradient.includes('#d') || gradient.includes('#e') || gradient.includes('#f')) {
                    theme.hover_style = 'btn-dark-text'; 
                } else {
                    theme.hover_style = 'btn-light-text';
                }
            }
            return themes;
        }

        THEMES = finalizeThemes(THEMES);
    
        function applyTheme(name) {
            const theme = THEMES[name];
            if (theme) {
                const root = document.documentElement;
                for (const [key, value] of Object.entries(theme)) {
                    if(key !== 'hover_style') {
                        root.style.setProperty(key, value);
                    }
                }

                const buttons = document.querySelectorAll('.tab-button, .sector-button, #settings-btn');
                buttons.forEach(button => {
                    button.classList.remove('btn-light-text', 'btn-dark-text');
                    if (theme.hover_style) {
                        button.classList.add(theme.hover_style);
                    }
                });
            }
        }
    
        window.setTheme = function(name) {
            applyTheme(name);
            localStorage.setItem('midway-theme', name);
        }
    
        const availableThemeNames = Object.keys(THEMES);
        const savedTheme = localStorage.getItem('midway-theme');
        let themeToLoad = DEFAULT_THEME_NAME;

        if (savedTheme && availableThemeNames.includes(savedTheme)) {
            themeToLoad = savedTheme;
        }
        
        applyTheme(themeToLoad);
    
        document.addEventListener('DOMContentLoaded', () => {
            const themeSelect = document.getElementById('theme-select');
            if (themeSelect) {
                themeSelect.innerHTML = '';
                availableThemeNames.forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                    themeSelect.appendChild(option);
                });
                themeSelect.value = themeToLoad;
            }
        });
    })();
    </script>
</head>
<body>
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="close-modal-btn" class="close-btn">&times;</button>
            <h3>Display Settings</h3>
            <label for="theme-select">Theme:</label>
            <select id="theme-select" onchange="setTheme(this.value)"></select>
        </div>
    </div>

    <div class="header">
        <h1>The Battle of Midway</h1>
        <p>June 4–7, 1942 • The Turning Point in the Pacific • Knowledge Base Explorer</p>
    </div>

    <div class="nav-tabs">
        <button class="tab-button active" data-tab="overview">Overview</button>
        <button class="tab-button" data-tab="prelude">Prelude to Battle</button>
        <button class="tab-button" data-tab="duel">The Carrier Duel</button>
        <button class="tab-button" data-tab="diversion">The Aleutian Diversion</button>
        <button class="tab-button" data-tab="losses">Losses & Aftermath</button>
        <button class="tab-button" data-tab="search">Search Knowledge</button>
        <button id="settings-btn" title="Settings">⚙️</button>
    </div>

    <div class="container">
        <div id="overview" class="tab-content active">
             <div class="section-card">
                <h2 class="section-title">Midway: The Decisive Blow</h2>
                <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                    Just six months after the attack on Pearl Harbor, the United States Navy delivered a stunning and decisive victory against the Imperial Japanese Navy (IJN). Fought near the tiny US mid-Pacific base at Midway Atoll, this pivotal battle destroyed the heart of the Japanese carrier fleet, blunting their eastward expansion and turning the tide of the war in the Pacific.
                </p>

                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">3</span>
                        <div class="stat-label">U.S. Aircraft Carriers</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">4</span>
                        <div class="stat-label">Japanese Aircraft Carriers</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">~360</span>
                        <div class="stat-label">U.S. Aircraft (Total)</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">~270</span>
                        <div class="stat-label">Japanese Carrier Aircraft</div>
                    </div>
                </div>

                <div class="interactive-map">
                    <h3 style="color: var(--accent-1); margin-bottom: 1rem;">The Kido Butai: The Japanese Carrier Strike Force</h3>
                    <p>Click on each carrier to learn its fate on June 4, 1942:</p>
                    <div class="sector-buttons">
                        <button class="sector-button" data-sector="akagi">Akagi</button>
                        <button class="sector-button" data-sector="kaga">Kaga</button>
                        <button class="sector-button" data-sector="soryu">Sōryū</button>
                        <button class="sector-button" data-sector="hiryu">Hiryū</button>
                    </div>

                    <div id="akagi-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">Akagi (Flagship)</h4>
                        <p><strong>Fate:</strong> Struck by dive bombers from USS Enterprise. A single bomb hit ignited fueled and armed aircraft in the hangar, leading to uncontrollable fires. Scuttled on June 5.</p>
                    </div>
                    <div id="kaga-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">Kaga</h4>
                        <p><strong>Fate:</strong> Struck by at least four bombs from USS Enterprise's dive bombers. The resulting explosions and fires destroyed the ship; it sank that evening.</p>
                    </div>
                    <div id="soryu-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">Sōryū</h4>
                        <p><strong>Fate:</strong> Struck by three bombs from USS Yorktown's dive bombers. The fires reached the bomb magazines, and the ship sank within hours, taking over 700 men with her.</p>
                    </div>
                    <div id="hiryu-detail" class="sector-detail">
                        <h4 style="color: var(--accent-1);">Hiryū</h4>
                        <p><strong>Fate:</strong> The last surviving carrier, its planes crippled USS Yorktown. It was later found and struck by dive bombers from Enterprise and Yorktown. Scuttled on June 5.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="prelude" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Codebreaking and Desperation</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <h3 class="sector-name">Japanese Objective</h3>
                        <p>Humiliated by the Doolittle Raid on Tokyo, Admiral Yamamoto sought to force the US Pacific Fleet into a decisive battle and destroy its remaining carriers. The plan was to invade Midway Atoll, an objective so vital that the US Navy would have no choice but to respond.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">The Commanders</h3>
                        <p><strong>U.S. Pacific Fleet:</strong> Adm. Chester Nimitz</p>
                        <p><strong>U.S. Task Forces:</strong> RAdm. Frank J. Fletcher & RAdm. Raymond Spruance</p>
                        <p><strong>Japanese Combined Fleet:</strong> Adm. Isoroku Yamamoto</p>
                        <p><strong>Japanese Strike Force:</strong> VAdm. Chūichi Nagumo</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">The Intelligence Victory</h3>
                        <p>US Navy cryptanalysts at Station HYPO in Hawaii, led by Joseph Rochefort, partially broke the Japanese naval code JN-25. They deduced that a location designated "AF" was the target. By having the Midway garrison broadcast an uncoded message about a fresh water shortage, they confirmed "AF" was Midway, uncovering the Japanese plan.</p>
                    </div>
                </div>
                <div class="subsection">
                    <h3 class="section-title">Timeline to Battle</h3>
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-time">May 8, 1942</div>
                            <h4>Battle of the Coral Sea</h4>
                            <p>A strategic victory for the US, but the carrier USS Lexington is sunk and USS Yorktown is heavily damaged, seemingly taking it out of the fight for Midway.</p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-time">May 20, 1942</div>
                            <h4>"AF is short of water"</h4>
                            <p>Station HYPO confirms the Japanese target is Midway, giving Adm. Nimitz a priceless strategic advantage. He knows where and when to concentrate his forces.</p>
                        </div>
                         <div class="timeline-item">
                            <div class="timeline-time">May 28, 1942</div>
                            <h4>The Miracle at Pearl Harbor</h4>
                            <p>After just 72 hours of frantic repairs at Pearl Harbor, the heavily damaged USS Yorktown puts to sea, a feat the Japanese believed impossible. This third carrier would prove decisive.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="duel" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">The Air Battle - June 4, 1942</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <div class="sector-name">Morning Strike on Midway</div>
                        <p>At 04:30, Nagumo launches his first wave of 108 aircraft to neutralize Midway's airfield. The attack does significant damage, but the commander radios back that a second strike is needed.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">The Torpedo Bombers' Sacrifice</div>
                        <p>Squadrons of slow, outdated TBD Devastator torpedo bombers from all three US carriers attack the Japanese fleet. They score no hits and suffer catastrophic losses, but their sacrifice draws the Japanese fighter cover down to sea level.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">"The Five Fateful Minutes"</div>
                        <p>With the Japanese fighters out of position, American SBD Dauntless dive bombers from the Enterprise and Yorktown arrive overhead unopposed. Below them, the Japanese carrier decks are crowded with refueling and re-arming planes, making them incredibly vulnerable.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">Three Carriers Burn</div>
                        <p>Between 10:22 and 10:28 AM, the dive bombers strike. In less than six minutes, they score fatal hits on the carriers Akagi, Kaga, and Sōryū, turning the tide of the entire battle in a flash.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">Hiryū's Last Stand</div>
                        <p>The sole remaining Japanese carrier, Hiryū, launches two counterattacks that find and cripple the USS Yorktown. But later that afternoon, US scout planes locate Hiryū, and a final dive bomber strike seals its doom.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="diversion" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Operation AL: The Aleutian Diversion</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <h3 class="sector-name">The Japanese Plan</h3>
                        <p>As part of their complex battle plan, the Japanese launched a secondary attack on the Aleutian Islands off Alaska. The goal was to draw a portion of the US Pacific Fleet north, away from the main engagement at Midway.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">Nimitz's Gamble</h3>
                        <p>Armed with the priceless intelligence from Station HYPO, Admiral Nimitz knew the Aleutian attack was a feint. He sent only a small cruiser and destroyer force to the north, while concentrating his three precious carriers at "Point Luck," the perfect ambush position northeast of Midway.</p>
                    </div>
                </div>
                <div class="subsection">
                    <h3>Strategic Impact</h3>
                    <p style="font-size: 1.1rem; line-height: 1.7;">
                        The failure of the Aleutian diversion was a key example of the over-complexity of the Japanese plan. It divided their forces and relied on the element of surprise. American codebreaking completely negated this surprise, turning Japan's intricate plan against them and allowing Nimitz to achieve decisive local superiority where it mattered most.
                    </p>
                </div>
            </div>
        </div>

        <div id="losses" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Losses & Aftermath</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">4 Carriers</span>
                        <div class="stat-label">Japanese Fleet Carriers Lost</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">1 Carrier</span>
                        <div class="stat-label">U.S. Fleet Carrier Lost (Yorktown)</div>
                    </div>
                     <div class="stat-card">
                        <span class="stat-number">~3,057</span>
                        <div class="stat-label">Japanese Casualties</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">~362</span>
                        <div class="stat-label">U.S. Casualties</div>
                    </div>
                </div>
                <div class="sector-grid">
                    <div class="sector-card">
                        <h3 class="sector-name">The Irreplaceable Blow</h3>
                        <p>Japan lost four of its six fleet carriers and, more importantly, a huge number of its most experienced veteran naval aviators. This was a loss from which the IJN's carrier air power would never fully recover.</p>
                    </div>
                     <div class="sector-card">
                        <h3 class="sector-name">The Turning Point</h3>
                         <p>Midway permanently blunted Japan's offensive capability in the Pacific. The strategic initiative passed to the United States, allowing them to begin their own offensive operations, starting with the invasion of Guadalcanal just two months later.</p>
                    </div>
                     <div class="sector-card">
                        <h3 class="sector-name">Supremacy of the Carrier</h3>
                         <p>The battle, fought entirely by aircraft without the opposing surface fleets ever sighting one another, definitively proved that the aircraft carrier—not the battleship—was the new queen of naval warfare.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="search" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Search the Knowledge Base</h2>
                <input type="text" id="searchInput" class="search-box" placeholder="Search for people, ships, aircraft, or any topic...">
                
                <div id="searchResults">
                    <p style="text-align: center; color: var(--text-secondary); font-style: italic; margin: 2rem 0;">
                        Enter a search term above to explore the Midway knowledge base.<br>
                        Try searching for: "Nimitz", "Yamamoto", "Yorktown", "Station HYPO", "Dauntless", etc.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Knowledge base for searching
        const knowledgeBase = {
            "Nimitz": "Admiral Chester W. Nimitz, Commander in Chief of the U.S. Pacific Fleet. He made the crucial decisions to trust the intelligence, repair the Yorktown, and set the ambush.",
            "Yamamoto": "Admiral Isoroku Yamamoto, Commander-in-Chief of Japan's Combined Fleet. He conceived the Midway plan to destroy the US carriers but commanded from his flagship Yamato, too far away to influence the battle.",
            "Nagumo": "Vice Admiral Chūichi Nagumo commanded the Kido Butai, the Japanese carrier strike force. His fateful decision to re-arm his second wave of planes for a strike on ships instead of the island left his carriers vulnerable.",
            "Spruance": "Rear Admiral Raymond A. Spruance commanded Task Force 16 (Enterprise and Hornet). His calm, decisive leadership after Fletcher was forced to abandon Yorktown was critical to the victory.",
            "Fletcher": "Rear Admiral Frank Jack Fletcher was the senior tactical commander at the start of the battle, commanding Task Force 17 (Yorktown).",
            "Rochefort": "Commander Joseph J. Rochefort was the head of Station HYPO, the U.S. Navy's codebreaking unit in Hawaii. His team's breaking of the JN-25 code was the single most important factor in the American victory.",
            "Station HYPO": "The U.S. Navy's signals intelligence and cryptanalysis unit at Pearl Harbor. They successfully identified Midway as the Japanese target, designated 'AF'.",
            "JN-25": "The primary operational code used by the Imperial Japanese Navy. Partial breaking of this code provided the Americans with the enemy's plan.",
            "AF": "The Japanese coded designator for their objective. Station HYPO confirmed 'AF' meant Midway by tricking the Japanese into reporting that the 'AF' garrison was short on fresh water.",
            "Yorktown": "USS Yorktown (CV-5), a US carrier heavily damaged at the Coral Sea. It was miraculously repaired in 72 hours and played a vital role at Midway before being crippled by planes from Hiryū and sunk by a submarine.",
            "Enterprise": "USS Enterprise (CV-6), 'The Big E.' Her dive bombers were responsible for sinking the carriers Kaga, Akagi, and Hiryū.",
            "Hornet": "USS Hornet (CV-8), the third US carrier at the battle. Its torpedo squadron was wiped out, and its dive bombers initially failed to find the enemy, but it contributed to the overall effort.",
            "Kido Butai": "The main carrier strike force of the Imperial Japanese Navy, consisting of the four fleet carriers Akagi, Kaga, Sōryū, and Hiryū at Midway.",
            "SBD Dauntless": "The Douglas SBD Dauntless was the primary US dive bomber. Though slow, it was rugged and accurate, and became the hero of the battle by sinking all four Japanese carriers.",
            "TBD Devastator": "The Douglas TBD Devastator was the US Navy's outdated torpedo bomber. The torpedo squadrons suffered horrific losses in their attacks, but are credited with drawing away Japanese fighter cover at a critical moment.",
            "Point Luck": "The code name for the rendezvous point northeast of Midway where the US carriers lay in wait to ambush the Japanese fleet."
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeSectorButtons();
            initializeSearch();
            initializeModal();
        });

        function initializeModal() {
            const modal = document.getElementById('settings-modal');
            const openBtn = document.getElementById('settings-btn');
            const closeBtn = document.getElementById('close-modal-btn');

            if (modal && openBtn && closeBtn) {
                openBtn.addEventListener('click', () => {
                    modal.classList.add('show');
                });

                closeBtn.addEventListener('click', () => {
                    modal.classList.remove('show');
                });

                modal.addEventListener('click', (event) => {
                    if (event.target === modal) {
                        modal.classList.remove('show');
                    }
                });
            }
        }

        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
        }

        function showTab(tabName) {
            try {
                const tabContents = document.querySelectorAll('.tab-content');
                tabContents.forEach(content => {
                    if (content && content.classList) {
                        content.classList.remove('active');
                    }
                });

                const tabButtons = document.querySelectorAll('.tab-button');
                tabButtons.forEach(button => {
                    if (button && button.classList) {
                        button.classList.remove('active');
                    }
                });

                const targetTab = document.getElementById(tabName);
                if (targetTab && targetTab.classList) {
                    targetTab.classList.add('active');
                }

                const activeButton = document.querySelector(`[data-tab="${tabName}"]`);
                if (activeButton && activeButton.classList) {
                    activeButton.classList.add('active');
                }
            } catch (error) {
                console.error('Error in showTab:', error);
            }
        }

        function initializeSectorButtons() {
            const sectorButtons = document.querySelectorAll('.sector-button');
            sectorButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const sectorName = this.getAttribute('data-sector');
                    showSectorDetail(sectorName, this);
                });
            });
        }

        function showSectorDetail(sector, clickedButton) {
            try {
                const details = document.querySelectorAll('.sector-detail');
                details.forEach(detail => detail.classList.remove('show'));

                const buttons = document.querySelectorAll('.sector-button');
                buttons.forEach(button => button.classList.remove('active'));

                const targetDetail = document.getElementById(sector + '-detail');
                if (targetDetail) {
                    targetDetail.classList.add('show');
                    clickedButton.classList.add('active');
                }
            } catch (error) {
                console.error('Error in showSectorDetail:', error);
            }
        }

        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keyup', searchContent);
            }
        }

        function searchContent() {
            try {
                const searchInput = document.getElementById('searchInput');
                const resultsDiv = document.getElementById('searchResults');
                
                if (!searchInput || !resultsDiv) return;
                
                const searchTerm = searchInput.value.toLowerCase();

                if (searchTerm.length < 2) {
                    resultsDiv.innerHTML = '<p style="text-align: center; color: var(--text-secondary); font-style: italic; margin: 2rem 0;">Enter a search term above to explore the Midway knowledge base.<br>Try searching for: "Nimitz", "Yamamoto", "Yorktown", "Station HYPO", "Dauntless", etc.</p>';
                    return;
                }

                let results = [];
                
                for (const key in knowledgeBase) {
                    if (knowledgeBase.hasOwnProperty(key)) {
                        const value = knowledgeBase[key];
                        if (key.toLowerCase().includes(searchTerm) || value.toLowerCase().includes(searchTerm)) {
                            results.push({
                                title: key,
                                content: value,
                                relevance: key.toLowerCase().startsWith(searchTerm) ? 2 : 1
                            });
                        }
                    }
                }

                results.sort((a, b) => b.relevance - a.relevance);

                if (results.length === 0) {
                    resultsDiv.innerHTML = `<div class="section-card"><h3 style="color: var(--accent-1);">No results found for "${searchInput.value}"</h3><p>Try searching for commander names, ships, aircraft, or key terms.</p></div>`;
                    return;
                }

                let resultHTML = `<h3 style="color: var(--accent-1); margin-bottom: 1.5rem;">Search Results for "${searchInput.value}"</h3>`;
                
                for (let i = 0; i < results.length; i++) {
                    const result = results[i];
                    const highlightedContent = result.content.replace(new RegExp(searchTerm, 'gi'), '<span class="highlight">$&</span>');
                    
                    resultHTML += `<div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid var(--accent-1);"><h4 style="color: var(--accent-1); margin-bottom: 0.8rem;">${result.title}</h4><p style="line-height: 1.6;">${highlightedContent}</p></div>`;
                }

                resultsDiv.innerHTML = resultHTML;
            } catch (error) {
                console.error('Error in searchContent:', error);
            }
        }
    </script>
</body>
</html>
