<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross and Atonement - A History Report</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg,#2c3e50 0%,#34495e 100%);
            --accent-1: #e74c3c;
            --accent-2: #c03b2b;
            --btn-gradient: linear-gradient(45deg,#e74c3c,#c0392b);
            --accent-1-rgb: 231, 76, 60;
            --accent-warning: #ffc107;
            --accent-warning-rgb: 255, 193, 7;
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: var(--bg-gradient);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .header {
            background: rgba(0,0,0,0.3);
            padding: 2rem;
            text-align: center;
            border-bottom: 3px solid var(--accent-1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-top: 0;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, var(--accent-1), var(--accent-2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            filter: drop-shadow(0 0 15px rgba(var(--accent-1-rgb), 0.3));
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.2);
            padding: 1rem;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        /* --- FINAL BUTTON RULES START --- */

        /* Base style for ALL buttons */
        .tab-button, #settings-btn, .sector-button {
            padding: 12px 24px;
            background: var(--ui-background);
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Specific settings for the icon */
        #settings-btn {
            font-size: 1.2rem;
            padding: 10px 15px;
        }

        /* HOVER state for buttons */
        .tab-button:hover, .sector-button:hover, #settings-btn:hover {
            background: var(--btn-gradient);
            transform: translateY(-2px);
            color: var(--btn-text-hover);
        }

        /* ACTIVE state for selected buttons */
        .tab-button.active, .sector-button.active {
            background: var(--btn-gradient);
            border-color: var(--accent-2);
            transform: translateY(-2px);
            color: var(--btn-text-active);
        }
        
        /* --- FINAL BUTTON RULES END --- */

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: #2c3e50;
            padding: 2rem;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            text-align: center;
            position: relative;
            width: 90%;
            max-width: 400px;
        }

        .modal-content h3 {
            color: var(--accent-1);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .modal-content label {
            font-size: 1.1rem;
            margin-right: 10px;
        }

        #theme-select {
            background-color: var(--ui-background);
            color: var(--text-primary);
            border: 1px solid var(--accent-2);
            border-radius: 5px;
            padding: 8px;
            font-size: 1rem;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            background: none;
            border: none;
            cursor: pointer;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: var(--text-primary);
            text-decoration: none;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .section-title {
            color: var(--accent-1);
            font-size: 1.8rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-1);
        }

        .subsection {
            margin: 1.5rem 0;
        }

        .subsection h3 {
            color: var(--accent-1);
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }

        .subsection h4 {
            color: var(--accent-2);
            font-size: 1.1rem;
            margin: 1rem 0 0.5rem 0;
        }

        .sector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .sector-card {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid var(--accent-1);
            transition: transform 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .sector-card:hover {
            transform: translateY(-5px);
            background: rgba(255,255,255,0.1);
        }

        .sector-name {
            color: var(--accent-1);
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .casualties-highlight {
            background: rgba(var(--accent-warning-rgb), 0.15);
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid var(--accent-warning);
            margin: 1rem 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

           .stat-card {
            background: var(--ui-background-accent);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-1);
            display: block;
        }

        .stat-label {
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }
        
        .timeline {
            position: relative;
            padding-left: 2rem;
            margin-top: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--accent-1);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            padding-left: 2rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2.05rem;
            top: 5px;
            width: 12px;
            height: 12px;
            background: var(--accent-1);
            border-radius: 50%;
            border: 2px solid var(--ui-background);
        }

        .timeline-time {
            color: var(--accent-1);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .search-box {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
            margin-bottom: 2rem;
        }

        .search-box::placeholder {
            color: var(--text-secondary);
        }

        .highlight {
            background: rgba(var(--accent-1-rgb), 0.3);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .interactive-map {
            background: var(--container-background-subtle);
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 2rem;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .sector-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .sector-detail {
            display: none;
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .sector-detail.show {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            .nav-tabs {
                flex-direction: column;
                align-items: center;
            }
            .container {
                padding: 1rem;
            }
            .sector-grid {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <script>
    // Self-executing function to manage all theme logic.
    (function() {
        const DEFAULT_THEME_NAME = 'cyber-night';
    
        let THEMES = {
            'cyber-night': {
                '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
                '--accent-1': '#a8b8d0', '--accent-1-rgb': '168, 184, 208',
                '--accent-2': '#8899b3',
                '--btn-gradient': 'linear-gradient(45deg,#1a1a3a,#2e2e5e)',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--ui-background': '#34495e',
                '--ui-background-accent': 'rgba(52, 73, 94, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--btn-text-active': '#ecf0f1'
            },
            'scorched-gold': {
                '--bg-gradient': 'linear-gradient(135deg,#0a231f 0%,#193a33 50%,#2e5e54 100%)',
                '--ui-background': '#345e56',
                '--ui-background-accent': 'rgba(52, 94, 86, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--accent-1': '#f0c475',
                '--accent-2': '#d4a24c',
                '--btn-gradient': 'linear-gradient(45deg,#f0c475,#d4a24c)',
                '--accent-1-rgb': '240, 196, 117',
                '--btn-text-active': '#2a1d15',
                '--btn-text-hover': '#2a1d15',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57'
            },
            'red-alert': {
                '--bg-gradient': 'linear-gradient(135deg,#0a0a23 0%,#1a1a3a 50%,#2e2e5e 100%)',
                '--ui-background': '#34495e',
                '--ui-background-accent': 'rgba(52, 73, 94, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--accent-1': '#e74c3c',
                '--accent-2': '#c03b2b',
                '--btn-gradient': 'linear-gradient(45deg,#e74c3c,#c0392b)',
                '--accent-1-rgb': '231, 76, 60',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--btn-text-active': '#ffffff'
            },
            'teal-matrix': {
                '--bg-gradient': 'linear-gradient(135deg,#0a231c 0%,#1a3a31 50%,#2e5e50 100%)',
                '--accent-1': '#ace0d5', '--accent-1-rgb': '172, 224, 213',
                '--accent-2': '#92b3a9',
                '--btn-gradient': 'linear-gradient(45deg,#1a3a31,#2e5e50)',
                '--accent-warning': '#e8b339',
                '--accent-warning-rgb': '232, 179, 57',
                '--ui-background': '#345e55',
                '--ui-background-accent': 'rgba(52, 94, 85, 0.8)',
                '--container-background-subtle': 'rgba(0, 0, 0, 0.3)',
                '--btn-text-active': '#ecf0f1'
            }
        };

        function applyTheme(name) {
            const theme = THEMES[name];
            if (theme) {
                const root = document.documentElement;
                for (const [key, value] of Object.entries(theme)) {
                    root.style.setProperty(key, value);
                }
            }
        }
    
        window.setTheme = function(name) {
            applyTheme(name);
            localStorage.setItem('atonement-history-theme', name);
        }
    
        const availableThemeNames = Object.keys(THEMES);
        const savedTheme = localStorage.getItem('atonement-history-theme');
        let themeToLoad = DEFAULT_THEME_NAME;

        if (savedTheme && availableThemeNames.includes(savedTheme)) {
            themeToLoad = savedTheme;
        }
        
        applyTheme(themeToLoad);
    
        document.addEventListener('DOMContentLoaded', () => {
            const themeSelect = document.getElementById('theme-select');
            if (themeSelect) {
                availableThemeNames.forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                    themeSelect.appendChild(option);
                });
                themeSelect.value = themeToLoad;
            }
        });
    })();
    </script>
</head>
<body>
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="close-modal-btn" class="close-btn">&times;</button>
            <h3>Display Settings</h3>
            <label for="theme-select">Theme:</label>
            <select id="theme-select" onchange="setTheme(this.value)"></select>
        </div>
    </div>

    <div class="header">
        <h1>Cross and Atonement</h1>
        <p>A Brief History of Christian Understanding • Knowledge Base</p>
    </div>

    <div class="nav-tabs">
        <button class="tab-button active" data-tab="overview">Overview</button>
        <button class="tab-button" data-tab="early-church">Early Church</button>
        <button class="tab-button" data-tab="medieval-reformation">Medieval & Reformation</button>
        <button class="tab-button" data-tab="modern-era">Modern Era</button>
        <button class="tab-button" data-tab="key-thinkers">Key Thinkers</button>
        <button class="tab-button" data-tab="search">Search</button>
        <button id="settings-btn" title="Settings">⚙️</button>
    </div>

    <div class="container">
        <div id="overview" class="tab-content active">
             <div class="section-card">
                <h2 class="section-title">The Central Mystery</h2>
                <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                    The death of Jesus on the cross is the central event of the Christian faith, yet its precise meaning has been understood in profoundly different ways throughout history. There is no single, universally accepted "theory" of the atonement in the Bible. Instead, there are a series of powerful metaphors—victory, sacrifice, justice, healing—that different eras have emphasized. This report provides a high-level overview of the major models Christians have used to understand the significance of the cross.
                </p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">~1000</span>
                        <div class="stat-label">Years of Christus Victor Dominance</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">1098 AD</span>
                        <div class="stat-label">Anselm Writes "Cur Deus Homo"</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">4+</span>
                        <div class="stat-label">Major Atonement Theories</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">2000+</span>
                        <div class="stat-label">Years of Theological Development</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="early-church" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">The Early Church (c. 33 – 1000 AD)</h2>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-time">c. 33-100 AD</div>
                        <h4>The Apostolic Era</h4>
                        <p>The New Testament writers use a rich tapestry of metaphors for the cross: sacrifice, reconciliation, redemption, and justification. The dominant theme, however, is one of triumph over the powers of sin, death, and the devil.</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">c. 180 AD</div>
                        <h4>Irenaeus and Recapitulation</h4>
                        <p>Irenaeus of Lyons articulates the cross as a "recapitulation" of Adam's failure. Christ, as the new Adam, lives a life of perfect obedience, culminating in his victory over temptation and death on the cross, thereby reversing Adam's curse.</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">c. 250 AD</div>
                        <h4>Ransom Theory Emerges</h4>
                        <p>Thinkers like Origen develop a specific version of the victory theme known as the Ransom Theory. In this model, humanity is held captive by Satan, and Christ's death is a ransom paid to the devil to secure our release. This view becomes popular but is later criticized.</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">c. 400 - 1000 AD</div>
                        <h4>Christus Victor: The Dominant View</h4>
                        <p>For the first millennium of the church, the primary understanding of the cross is "Christus Victor" (Christ the Victor). The cross is not seen as a payment to God or the devil, but as a decisive divine invasion into enemy territory, liberating humanity from the bondage of the "powers of darkness."</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="medieval-reformation" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Medieval & Reformation Shifts (c. 1098 – 1600)</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <div class="sector-name">Anselm & Satisfaction Theory</div>
                        <p>In his work "Cur Deus Homo" (1098), Anselm of Canterbury shifts the focus. He argues that human sin has offended God's infinite honor. Since humans cannot repay this debt, the God-man, Jesus, pays the debt of honor on our behalf through his perfect obedience and death.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">Martin Luther & The Great Exchange</div>
                        <p>The reformer Martin Luther emphasizes the cross as a "Great Exchange." Christ takes our sin and guilt upon himself, and in return, we receive his perfect righteousness. This transaction is received by faith alone.</p>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">John Calvin & Penal Substitution</div>
                        <p>John Calvin systematizes the Reformation view into what becomes known as Penal Substitutionary Atonement (PSA). In this legal model, God's justice requires a penalty for sin. Christ acts as our substitute on the cross, absorbing the wrath of God that we deserved, thus satisfying the demands of divine justice.</p>
                        <div class="casualties-highlight">
                            <strong>Result:</strong> Penal Substitution becomes the dominant and most influential theory of the atonement in many Protestant traditions, particularly in the English-speaking world.
                        </div>
                    </div>
                    <div class="sector-card">
                        <div class="sector-name">Abelard & Moral Influence</div>
                        <p>Peter Abelard (a contemporary of Anselm) proposed the Moral Influence theory. He argued the primary purpose of the cross was not to satisfy God's honor or justice, but to be the ultimate demonstration of God's love for humanity, which in turn softens our hearts and leads us to repentance.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="modern-era" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Modern Alternatives & Renewals</h2>
                <div class="sector-grid">
                    <div class="sector-card">
                        <h3 class="sector-name">Moral Influence Renewed</h3>
                        <p>In the liberal theology of the 19th and 20th centuries, thinkers like Horace Bushnell revived and popularized the Moral Influence theory, reacting against the perceived harshness of the penal substitution model.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">Girard & Mimetic Theory</h3>
                        <p>Philosopher René Girard offered a radical re-reading. He argued the cross is not a divine sacrifice, but a revelation of human violence. It exposes the "scapegoat mechanism" that founds all human cultures, showing God on the side of the victim, not the sacrificers.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">Christus Victor Renewed</h3>
                        <p>In 1931, Gustaf Aulén's book "Christus Victor" argued that the early church's victory model was the true "classic" view. This has been powerfully revived by modern theologians like Greg Boyd, who emphasize the cross as a spiritual warfare victory over cosmic powers.</p>
                    </div>
                     <div class="sector-card">
                        <h3 class="sector-name">N.T. Wright & Covenant Justice</h3>
                        <p>N.T. Wright argues that previous models miss the larger biblical story. For Wright, the cross is the ultimate covenant-fulfilling act, where Jesus, as Israel's representative, exhausts the curse of the old covenant to launch God's new creation, defeating evil and establishing God's restorative justice in the world.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="key-thinkers" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Key Thinkers</h2>
                <div class="sector-grid">
                     <div class="sector-card">
                        <h3 class="sector-name">Irenaeus (c. 130–202)</h3>
                        <p>An early church father who articulated the "recapitulation" theory, a key part of the Christus Victor tradition, where Christ's life and death reverse the failure of Adam.</p>
                     </div>
                     <div class="sector-card">
                        <h3 class="sector-name">Anselm (c. 1033–1109)</h3>
                        <p>Archbishop of Canterbury whose "Satisfaction Theory" shifted the focus of atonement from victory over Satan to satisfying God's offended honor, laying the groundwork for later legal models.</p>
                     </div>
                     <div class="sector-card">
                        <h3 class="sector-name">John Calvin (1509–1564)</h3>
                        <p>A key Protestant Reformer who systematized the idea of Christ as a substitute who bears the legal penalty (wrath) for sin, a view known as Penal Substitutionary Atonement.</p>
                    </div>
                    <div class="sector-card">
                        <h3 class="sector-name">Gustaf Aulén (1879–1977)</h3>
                        <p>A Swedish theologian whose 1931 book "Christus Victor" was instrumental in reintroducing the early church's "victory over evil" model to modern theology.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="search" class="tab-content">
            <div class="section-card">
                <h2 class="section-title">Search the Knowledge Base</h2>
                <input type="text" id="searchInput" class="search-box" placeholder="Search for theories, thinkers, eras...">
                
                <div id="searchResults">
                    <p style="text-align: center; color: var(--text-secondary); font-style: italic; margin: 2rem 0;">
                        Enter a search term above to explore the history of atonement.<br>
                        Try searching for: "Christus Victor", "Anselm", "PSA", "Girard", etc.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Knowledge base for searching
        const knowledgeBase = {
            "Christus Victor": "The dominant view for the first 1000 years of the church. It sees the cross as God's decisive victory over the powers of sin, death, and the devil, liberating humanity from bondage.",
            "Anselm": "Archbishop of Canterbury who developed the 'Satisfaction Theory' around 1098. He argued that Christ's death satisfied the debt to God's honor caused by human sin.",
            "Penal Substitution (PSA)": "Penal Substitutionary Atonement is a legal model most associated with the Protestant Reformation. It holds that Christ died as a substitute, taking the penalty (God's wrath) that humanity deserved for its sins.",
            "Moral Influence": "A theory, first articulated by Peter Abelard, which states that the primary effect of the cross is not on God, but on humanity. It is the ultimate demonstration of God's love, meant to soften our hearts and lead us to repentance.",
            "Girard": "René Girard, a French philosopher, proposed that the cross is a revelation of the scapegoat mechanism that underpins all human violence. God is revealed as the victim, not the sacrificer, thus ending the cycle of sacred violence.",
            "Ransom Theory": "An early version of the Christus Victor model, popular for a time, which posited that Christ's death was a ransom paid specifically to Satan to free humanity from his clutches.",
            "Calvin": "John Calvin was a primary architect of the Penal Substitution theory, systematizing it in his 'Institutes of the Christian Religion.'",
            "N.T. Wright": "A contemporary New Testament scholar who argues for a more narrative-based view, seeing the cross as the climax of Israel's story where Jesus exhausts the covenant curse to launch God's new creation."
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeSectorButtons();
            initializeSearch();
            initializeModal();
        });

        function initializeModal() {
            const modal = document.getElementById('settings-modal');
            const openBtn = document.getElementById('settings-btn');
            const closeBtn = document.getElementById('close-modal-btn');

            if (modal && openBtn && closeBtn) {
                openBtn.addEventListener('click', () => modal.classList.add('show'));
                closeBtn.addEventListener('click', () => modal.classList.remove('show'));
                modal.addEventListener('click', (event) => {
                    if (event.target === modal) modal.classList.remove('show');
                });
            }
        }

        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
        }

        function showTab(tabName) {
            try {
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
                document.getElementById(tabName).classList.add('active');
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            } catch (error) { console.error('Error in showTab:', error); }
        }

        function initializeSectorButtons() {
            const sectorButtons = document.querySelectorAll('.sector-button');
            sectorButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const sectorName = this.getAttribute('data-sector');
                    showSectorDetail(sectorName, this);
                });
            });
        }

        function showSectorDetail(sector, clickedButton) {
            try {
                document.querySelectorAll('.sector-detail').forEach(detail => detail.classList.remove('show'));
                document.querySelectorAll('.sector-button').forEach(button => button.classList.remove('active'));
                const targetDetail = document.getElementById(sector + '-detail');
                if (targetDetail) {
                    targetDetail.classList.add('show');
                    clickedButton.classList.add('active');
                }
            } catch (error) { console.error('Error in showSectorDetail:', error); }
        }

        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keyup', searchContent);
            }
        }

        function searchContent() {
            try {
                const searchInput = document.getElementById('searchInput');
                const resultsDiv = document.getElementById('searchResults');
                if (!searchInput || !resultsDiv) return;
                
                const searchTerm = searchInput.value.toLowerCase();

                if (searchTerm.length < 2) {
                    resultsDiv.innerHTML = `<p style="text-align: center; color: var(--text-secondary); font-style: italic; margin: 2rem 0;">Enter a search term above to explore the history of atonement.<br>Try searching for: "Christus Victor", "Anselm", "PSA", "Girard", etc.</p>`;
                    return;
                }

                let results = [];
                for (const key in knowledgeBase) {
                    if (knowledgeBase.hasOwnProperty(key)) {
                        const value = knowledgeBase[key];
                        if (key.toLowerCase().includes(searchTerm) || value.toLowerCase().includes(searchTerm)) {
                            results.push({
                                title: key,
                                content: value,
                                relevance: key.toLowerCase().startsWith(searchTerm) ? 2 : 1
                            });
                        }
                    }
                }

                results.sort((a, b) => b.relevance - a.relevance);

                if (results.length === 0) {
                    resultsDiv.innerHTML = `<div class="section-card"><h3 style="color: var(--accent-1);">No results found for "${searchInput.value}"</h3><p>Try searching for theories, thinkers, or eras.</p></div>`;
                    return;
                }

                let resultHTML = `<h3 style="color: var(--accent-1); margin-bottom: 1.5rem;">Search Results for "${searchInput.value}"</h3>`;
                for (let i = 0; i < results.length; i++) {
                    const result = results[i];
                    const highlightedContent = result.content.replace(new RegExp(searchTerm, 'gi'), `<span class="highlight">$&</span>`);
                    resultHTML += `<div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid var(--accent-1);"><h4 style="color: var(--accent-1); margin-bottom: 0.8rem;">${result.title}</h4><p style="line-height: 1.6;">${highlightedContent}</p></div>`;
                }

                resultsDiv.innerHTML = resultHTML;
            } catch (error) { console.error('Error in searchContent:', error); }
        }
    </script>
</body>
</html>
