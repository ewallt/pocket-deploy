<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Design Pattern Cooking ‚Äî Pescetariana</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --brand: #0ea5e9; }
    html { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; }

    /* Light baseline */
    .prose h2 { color: var(--brand); }
    .prose h3 { color: #0f172a; }
    .card { background: #ffffff; border: 1px solid rgba(2,6,23,.08); border-radius: 14px; box-shadow: 0 4px 24px rgba(2,6,23,.06); }
    .chip { background: rgba(14,165,233,.10); color: #075985; border: 1px solid rgba(14,165,233,.35); }
    .hover-card:hover { transform: translateY(-1px); box-shadow: 0 10px 30px rgba(2,6,23,.10); }
    .glass { backdrop-filter: saturate(130%) blur(6px); }
    .kbd { padding:.15rem .35rem; border:1px solid #cbd5e1; border-bottom-width:2px; border-radius:.35rem; background:#f8fafc; font-size:.85em;}
    ::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:8px}::-webkit-scrollbar-thumb:hover{background:#94a3b8}

    /* Dark theme (higher contrast) */
    .dark .card { background: #0f172a; border-color: #1f2937; }
    .dark .prose h2 { color: #7dd3fc; }   /* sky-300 */
    .dark .prose h3 { color: #e5e7eb; }   /* slate-200 */
    .dark .chip { background: rgba(56,189,248,.22); color: #e0f2fe; border-color: rgba(56,189,248,.55); }
    .dark .kbd{background:#0b1220;border-color:#334155;}
    .dark ::-webkit-scrollbar-thumb{background:#334155}
    /* Help content sit above sidebar on mobile */
    #content { position: relative; z-index: 10; }
  </style>
</head>
<body class="bg-slate-50 text-slate-800 dark:bg-slate-950 dark:text-slate-100 transition-colors">
  <noscript>Este app precisa de JavaScript habilitado.</noscript>

  <!-- Compact header; removed the long description; higher z-index -->
  <header class="sticky top-0 z-40 glass border-b border-slate-200/60 dark:border-slate-700/60 bg-white/80 dark:bg-slate-900/70">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-9 w-9 rounded-lg bg-cyan-500/15 border border-cyan-400/40 grid place-items-center">
          <span class="text-cyan-600 dark:text-cyan-300 font-bold">üç≥</span>
        </div>
        <h1 class="text-lg sm:text-xl font-bold leading-tight" id="app-title">Cozinha por Padr√µes ‚Äî Base Pescetariana</h1>
      </div>
      <div class="flex items-center gap-2">
        <div class="hidden md:flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-700 px-2 py-1 bg-white/70 dark:bg-slate-900/60">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M10 18a8 8 0 100-16 8 8 0 000 16z"/></svg>
          <input id="search" placeholder="Buscar nesta se√ß√£o‚Ä¶" class="bg-transparent outline-none placeholder:text-slate-400 w-56 text-sm">
        </div>
        <button id="themeToggle" class="rounded-lg border border-slate-200 dark:border-slate-700 px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800" title="Alternar tema">
          <span id="themeIcon">üåô</span>
        </button>
      </div>
    </div>
  </header>

  <!-- CONTENT FIRST on mobile; sidebar second; sticky only on lg+ -->
  <main class="max-w-7xl mx-auto px-4 py-6 grid grid-cols-1 lg:grid-cols-[1fr,280px] gap-6">
    <section class="space-y-6 order-1 lg:order-1" id="content"></section>

    <aside class="card p-3 lg:p-4 order-2 lg:order-2 lg:sticky lg:top-[64px]">
      <h2 class="font-semibold text-slate-700 dark:text-slate-200 mb-2">Se√ß√µes</h2>
      <nav id="nav" class="space-y-1 text-sm"></nav>
    </aside>
  </main>

  <footer class="max-w-7xl mx-auto px-4 pb-12 pt-2 text-center text-xs text-slate-500 dark:text-slate-400">
    Feito com padr√µes: t√©cnica + prote√≠na + base + molho + acidez/croc√¢ncia.
  </footer>

  <script>
  (function(){
    var APP_DATA = {
      "title": "Cozinha por Padr√µes ‚Äî Base Pescetariana",
      "description": "Guia pr√°tico para organizar o preparo de refei√ß√µes pescetarianas com padr√µes, t√©cnicas e planejamento.",
      "categories": {
        "inicio": {
          "display_order": 1, "name": "inicio", "display_name": "Como Usar",
          "introduction": "Pense em blocos: t√©cnica + prote√≠na + base (gr√£o/verdura) + molho-m√£e + acidez/croc√¢ncia. Troque apenas um bloco para variar sem esfor√ßo.",
          "paragraphs": [
            { "heading": "Fluxo de Noite √ötil (20‚Äì30 min)", "content": "1) Descongele/prepare a prote√≠na. 2) Escolha a t√©cnica pelo corte/espessura. 3) Reaque√ßa um gr√£o pronto e escolha um legume. 4) Aplique um molho-m√£e. 5) Finalize com lim√£o/ervas e um toque crocante." },
            { "heading": "Padr√µes vs. Receitas", "content": "Use os padr√µes como LEGO: um conjunto pequeno de t√©cnicas e molhos gera dezenas de pratos, sem depender de receitas longas." }
          ]
        },
        "despensa-base": {
          "display_order": 2, "name": "despensa-base", "display_name": "Despensa Base",
          "introduction": "Uma despensa curta e vers√°til reduz decis√µes e acelera o preparo.",
          "paragraphs": [
            { "heading": "Gr√£os & Massas", "content": "Arroz integral/jasmin, quinoa, cuscuz marroquino, farro (se achar), massa de trigo ou arroz. Cozinhe um lote semanal para bowls e acompanhamentos." },
            { "heading": "Leguminosas & Conservas", "content": "Gr√£o-de-bico, lentilha, feij√£o branco; tomate pelado; atum/sardinha (em √°gua/azeite); palmito, milho, ervilha; leite de coco; cogumelos." },
            { "heading": "Nozes, Sementes & Farinhas", "content": "Am√™ndoas, castanhas, nozes; chia, gergelim; panko, farinha de rosca/farinha de milho; aveia." },
            { "heading": "√Åcidos, √ìleos & Molhos", "content": "Azeite, √≥leo neutro; lim√£o/lima, vinagre de vinho/ma√ß√£; shoyu, miso, tahine, mostarda, gochujang, alcaparras." },
            { "heading": "Frescos de Rotina", "content": "Alho, cebola, gengibre, coentro/salsinha, cebolinha, piment√µes, folhas (r√∫cula/espinafre), tomates-cereja, pepino, lim√£o." }
          ]
        },
        "proteinas-do-mar": {
          "display_order": 3, "name": "proteinas-do-mar", "display_name": "Prote√≠nas do Mar",
          "introduction": "Escolha cortes pr√°ticos; porcione e congele em camada fina para descongelar r√°pido.",
          "paragraphs": [
            { "heading": "Peixes Magros", "content": "Til√°pia, linguado, pescada: ideais para vapor, papillote e assado r√°pido (8‚Äì12 min)." },
            { "heading": "Peixes Gordurosos", "content": "Salm√£o, sardinha, cavalinha: bons para selar + terminar no forno, grelhar, ou assar em alta." },
            { "heading": "Frutos do Mar", "content": "Camar√£o limpo (congelado), mexilh√£o, lula: coc√ß√£o curt√≠ssima (2‚Äì5 min) para n√£o borrachar." },
            { "heading": "Compra Inteligente", "content": "Cheiro de mar (n√£o de am√¥nia), carne firme, olho brilhante. Prefira peixes do dia ou pacotes congelados confi√°veis." }
          ]
        },
        "molhos-mae": {
          "display_order": 4, "name": "molhos-mae", "display_name": "Molhos-M√£e (Padr√µes)",
          "introduction": "Molhos base prontos em 5‚Äì10 min que viram dezenas de pratos. Fa√ßa 1‚Äì2 por semana.",
          "paragraphs": [
            { "heading": "Emuls√£o C√≠trica", "content": "Azeite + lim√£o + mostarda + mel/maple + sal/pimenta. Varia√ß√µes: laranja; alcaparras; ervas frescas." },
            { "heading": "Iogurte Herb√°ceo", "content": "Iogurte grego + alho ralado + lim√£o + dill/salsinha. Vers√µes: pepino (tzatziki), hortel√£." },
            { "heading": "Tomate Assado Express", "content": "Tomate-cereja + alho + azeite + sal; 15 min a 220 ¬∞C; amasse. Base para massas e peixe." },
            { "heading": "Tahine & Lim√£o", "content": "Tahine + lim√£o + √°gua at√© ponto + sal; adi√ß√µes: cominho, p√°prica, alho." },
            { "heading": "Moqueca-Base Ligeira", "content": "Refogue cebola/alho/piment√£o; some tomate + leite de coco + fio de dend√™; finalize com coentro." },
            { "heading": "Pesto de Coentro (Sem Queijo, se quiser)", "content": "Coentro + castanha de caju + alho + azeite + lim√£o + sal; ajuste com √°gua para textura de molho." }
          ]
        },
        "tecnicas": {
          "display_order": 5, "name": "tecnicas", "display_name": "T√©cnicas-Padr√£o",
          "introduction": "Selecione a t√©cnica pela espessura e tipo de corte. Cronometrar √© meio caminho.",
          "paragraphs": [
            { "heading": "Papillote (Forno)", "content": "Peixe + sal + fatias de lim√£o + ervas + fio de azeite em papel manteiga; 200‚Äì220 ¬∞C por 10‚Äì14 min." },
            { "heading": "Vapor R√°pido", "content": "Cesto de vapor; 6‚Äì8 min para fil√©s finos. Finalize com molho-m√£e e ervas." },
            { "heading": "Selar + Forno", "content": "Para salm√£o/postas: 2‚Äì3 min por lado na frigideira quente + 5‚Äì8 min no forno a 200 ¬∞C." },
            { "heading": "Poaching Suave", "content": "L√≠quido aromatizado (√°gua/caldo/leite de coco) a 80‚Äì90 ¬∞C por 6‚Äì10 min; ponto √∫mido e delicado." },
            { "heading": "Escabeche R√°pido", "content": "Finalize com vinagre/lim√£o + azeite + arom√°ticos; √≥timo para servir frio no dia seguinte." },
            { "heading": "Salmoura Rel√¢mpago", "content": "10 g sal/200 ml √°gua, 15‚Äì20 min; enx√°gue e seque. Textura mais suculenta e tempero por dentro." }
          ]
        },
        "templates-de-refeicao": {
          "display_order": 6, "name": "templates-de-refeicao", "display_name": "Templates de Refei√ß√£o",
          "introduction": "Use 'slots': gr√£o + verdura/legume + prote√≠na + molho; adicione acidez e croc√¢ncia no final.",
          "paragraphs": [
            { "heading": "Bowl 4-Slots", "content": "Gr√£o (arroz/quinoa) + folhas/legumes + peixe/camar√£o + molho-m√£e (tahine/iogurte/emuls√£o)." },
            { "heading": "Salada Proteica", "content": "Folhas + gr√£o ou leguminosa + peixe em lascas + crocante (panko tostado/nozes) + vinagrete." },
            { "heading": "Massa do Mar", "content": "Espaguete/penne + tomate assado ou pesto + camar√£o/atum + raspas e suco de lim√£o." },
            { "heading": "Moqueca Ligeira", "content": "Template da moqueca-base com postas/camar√£o; finalize com coentro e lim√£o." },
            { "heading": "Wrap/Taco", "content": "Tortilha + peixe assado em tiras + repolho + coentro + emuls√£o c√≠trica." },
            { "heading": "Sopa R√°pida", "content": "Caldo + legumes + leguminosa + peixe em cubos (poaching no final). Azeite/ervas na tigela." }
          ]
        },
        "perfis-de-sabor": {
          "display_order": 7, "name": "perfis-de-sabor", "display_name": "Perfis de Sabor",
          "introduction": "Perfis prontos ajudam a variar sem pensar em receita.",
          "paragraphs": [
            { "heading": "Brasileiro", "content": "Alho/cebola, piment√£o, coentro/salsinha, lim√£o, leite de coco, dend√™ (moderado)." },
            { "heading": "Mediterr√¢neo", "content": "Azeite, alho, lim√£o, tomate, azeitona, alcaparra, salsa/dill/or√©gano." },
            { "heading": "Japon√™s", "content": "Shoyu, gengibre, cebolinha, gergelim, miso; sirva com arroz e pepino." },
            { "heading": "Tailand√™s", "content": "Leite de coco, curry, lim√£o, coentro, pimenta; finalize com amendoim torrado." },
            { "heading": "Mexicano", "content": "Lim√£o, coentro, pimenta, cominho; milho/feij√£o; pico de gallo." },
            { "heading": "√Årabe", "content": "Tahine, lim√£o, cominho, p√°prica, hortel√£; pepino e tomate." }
          ]
        },
        "substituicoes-e-restricoes": {
          "display_order": 8, "name": "substituicoes-e-restricoes", "display_name": "Substitui√ß√µes & Restri√ß√µes",
          "introduction": "Trocas simples preservam o padr√£o mesmo com limita√ß√µes.",
          "paragraphs": [
            { "heading": "Sem Latic√≠nios", "content": "Iogurte ‚Üí tahine/'leitelho' de castanha; manteiga ‚Üí azeite; pesto sem queijo (castanha + lim√£o)." },
            { "heading": "Sem Gl√∫ten", "content": "Use arroz/quinoa/massa de arroz; panko ‚Üí farinha de milho/torrada de arroz triturada." },
            { "heading": "Alergia a Crust√°ceos", "content": "Substitua camar√£o/mexilh√£o/lula por peixes brancos/gordurosos nos templates." },
            { "heading": "Baixo FODMAP (geral)", "content": "Reduza alho/cebola; use azeite aromatizado com alho; priorize cebolinha verde (folhas)." }
          ]
        },
        "planejamento-semanal": {
          "display_order": 9, "name": "planejamento-semanal", "display_name": "Planejamento Semanal",
          "introduction": "Um pequeno 'ritual' semanal salva a semana inteira.",
          "paragraphs": [
            { "heading": "Preparo de 60 min (Domingo)", "content": "Cozinhe 1 gr√£o (arroz/quinoa), 1 leguminosa (gr√£o-de-bico), 2 molhos-m√£e; lave/parte legumes; porcione 3 noites de peixe no freezer." },
            { "heading": "Roteiro 30 min (Dia √ötil)", "content": "Descongele por√ß√£o ‚Üí escolha t√©cnica (papillote/vapor/selar) ‚Üí aque√ßa gr√£o ‚Üí legume r√°pido (salteado/forno) ‚Üí molho-m√£e + lim√£o/ervas." },
            { "heading": "Lista Sempre Comprar", "content": "Lim√£o, folhas, tomates-cereja, ervas frescas, alho/gengibre, 2 peixes da semana, 1 fruto do mar congelado, leite de coco, uma leguminosa." }
          ]
        },
        "exemplos-rapidos": {
          "display_order": 10, "name": "exemplos-rapidos", "display_name": "Exemplos R√°pidos (15‚Äì25 min)",
          "introduction": "Cartas-id√©ia para usar os padr√µes hoje.",
          "paragraphs": [
            { "heading": "Salm√£o Selado + Emuls√£o de Lim√£o", "content": "Selar 2‚Äì3 min por lado; forno 5‚Äì6 min; servir com quinoa, r√∫cula e emuls√£o c√≠trica." },
            { "heading": "Til√°pia em Papillote Mediterr√¢nea", "content": "Azeitona, alcaparra, tomate, ervas; 12 min a 210 ¬∞C; finalize com azeite e lim√£o." },
            { "heading": "Camar√£o Alho & Lim√£o + Massa", "content": "Saltear 2 min com alho; juntar tomate assado express; envolver espaguete; salsinha." },
            { "heading": "Moqueca Ligeira de Peixe", "content": "Base de leite de coco + dend√™; postas 8‚Äì10 min; piment√µes, coentro e lim√£o no final." },
            { "heading": "Bowl Asi√°tico com Atum", "content": "Arroz, pepino, cebolinha; atum em lata; molho shoyu-gengibre-gergelim; gergelim torrado." },
            { "heading": "Salada Grega com Sardinha", "content": "Folhas, pepino, tomate, cebola roxa, azeitona; sardinha; iogurte herb√°ceo (ou tahine)." }
          ]
        },
        "utensilios": {
          "display_order": 11, "name": "utensilios", "display_name": "Utens√≠lios Essenciais",
          "introduction": "Poucas pe√ßas resolvem 90% das noites.",
          "paragraphs": [
            { "heading": "Panelas & Frigideiras", "content": "Antiaderente m√©dia, inox pesada, ca√ßarola m√©dia, panela para vapor (ou cesto)." },
            { "heading": "Facas & T√°buas", "content": "Faca do chef + fileteira; t√°buas separadas para cru e pronto." },
            { "heading": "Miscel√¢nea", "content": "Assadeira, papel manteiga, pin√ßa, term√¥metro (opcional), peneira, potes com tampa." }
          ]
        },
        "congelamento": {
          "display_order": 12, "name": "congelamento", "display_name": "Congelar & Descongelar",
          "introduction": "Ganhe tempo porcionando bem.",
          "paragraphs": [
            { "heading": "Por√ß√µes Planas", "content": "Congele em saquinhos, camada fina; descongela mais r√°pido e por igual." },
            { "heading": "Descongelamento Seguro", "content": "Geladeira (8‚Äì12 h) ou √°gua fria corrente (embalado), trocando a √°gua; cozinhe imediatamente." },
            { "heading": "Temperos Ap√≥s Descongelar", "content": "Tempere pr√≥ximo √† coc√ß√£o para melhor textura." }
          ]
        }
      }
    };

    function $(sel, el){ return (el || document).querySelector(sel); }
    function $all(sel, el){ return Array.prototype.slice.call((el || document).querySelectorAll(sel)); }

    var KEY = 'dpc_cat';
    var activeKey = localStorage.getItem(KEY) || 'inicio';

    function sortCategories(cats){
      var arr = [];
      for (var id in cats){ if (cats.hasOwnProperty(id)) { var c = cats[id]; c.id = id; arr.push(c); } }
      arr.sort(function(a,b){ return (a.display_order || 999) - (b.display_order || 999); });
      return arr;
    }

    function renderNav(list){
      var nav = $('#nav');
      if (!nav) return;
      nav.innerHTML = '';
      for (var i=0;i<list.length;i++){
        (function(cat){
          var btn = document.createElement('button');
          btn.className = 'w-full text-left px-3 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 border border-transparent';
          btn.setAttribute('data-id', cat.id);
          if (cat.id === activeKey) btn.setAttribute('aria-selected', 'true');
          btn.innerHTML = '<div class="flex items-center gap-2"><span class="text-xs px-2 py-0.5 rounded chip">'+ String(cat.display_order).replace(/^(\d)$/, '0$1') +'</span><span>'+ (cat.display_name || cat.name) +'</span></div>';
          btn.addEventListener('click', function(){
            activeKey = cat.id;
            try { localStorage.setItem(KEY, activeKey); } catch(e){}
            updateActive();
            window.scrollTo(0,0);
          });
          nav.appendChild(btn);
        })(list[i]);
      }
      updateActive();
    }

    function updateActive(){
      var navBtns = $all('#nav button');
      for (var i=0;i<navBtns.length;i++){
        var isActive = navBtns[i].getAttribute('data-id') === activeKey;
        if (isActive) navBtns[i].setAttribute('aria-selected','true');
        else navBtns[i].removeAttribute('aria-selected');
      }
      var cat = APP_DATA.categories[activeKey] || APP_DATA.categories.inicio;
      renderCategory(cat);
    }

    function el(tag, cls, text){
      var e = document.createElement(tag);
      if (cls) e.className = cls;
      if (text != null) e.textContent = text;
      return e;
    }

    function renderCategory(cat){
      var content = $('#content');
      if (!content) return;
      content.innerHTML = '';

      var section = document.createElement('article');
      section.className = 'card hover-card p-5 md:p-6';

      var header = document.createElement('div');
      header.className = 'flex items-start justify-between gap-4 mb-3';
      var h2 = el('h2', 'text-2xl md:text-3xl font-bold', cat.display_name || cat.name);
      var copyBtn = el('button', 'hidden sm:inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 text-sm');
      copyBtn.innerHTML = '<span>Copiar se√ß√£o</span>';
      copyBtn.addEventListener('click', function(){ copySectionText(cat); });
      header.appendChild(h2);
      header.appendChild(copyBtn);

      var intro = el('p', 'text-slate-600 dark:text-slate-300 mb-4');
      intro.textContent = cat.introduction || '';

      var prose = el('div', 'prose prose-slate max-w-none dark:prose-invert');
      var arr = cat.paragraphs || [];
      for (var i=0;i<arr.length;i++){
        var p = arr[i];
        if (p.heading) prose.appendChild(el('h3','mt-6', p.heading));
        if (p.content) prose.appendChild(el('p','', p.content));
      }

      section.appendChild(header);
      section.appendChild(intro);
      section.appendChild(prose);
      content.appendChild(section);
    }

    function copySectionText(cat){
      var lines = [];
      lines.push(cat.display_name || cat.name);
      if (cat.introduction) lines.push(cat.introduction);
      var arr = cat.paragraphs || [];
      for (var i=0;i<arr.length;i++){
        var p = arr[i];
        if (p.heading) lines.push('\n' + p.heading.toUpperCase());
        if (p.content) lines.push(p.content);
      }
      var txt = lines.join('\n');
      if (navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(txt);
        toast('Conte√∫do copiado!');
      } else {
        var ta = document.createElement('textarea');
        ta.value = txt; document.body.appendChild(ta); ta.select();
        try { document.execCommand('copy'); toast('Conte√∫do copiado!'); } catch(e){}
        document.body.removeChild(ta);
      }
    }

    function toast(msg){
      var t = $('#toast');
      if (!t){
        t = document.createElement('div');
        t.id = 'toast';
        t.className = 'fixed bottom-4 left-1/2 -translate-x-1/2 bg-slate-900 text-white dark:bg-white dark:text-slate-900 px-4 py-2 rounded-lg shadow-lg';
        document.body.appendChild(t);
      }
      t.textContent = msg;
      t.style.opacity = '1';
      setTimeout(function(){ t.style.opacity = '0'; }, 1400);
    }

    function applyTheme(theme){
      if (theme === 'dark'){ document.documentElement.classList.add('dark'); $('#themeIcon').textContent = '‚òÄÔ∏è'; }
      else { document.documentElement.classList.remove('dark'); $('#themeIcon').textContent = 'üåô'; }
    }

    document.addEventListener('DOMContentLoaded', function(){
      var THEME_KEY = 'dpc_theme';
      var savedTheme = 'light';
      try {
        savedTheme = localStorage.getItem(THEME_KEY) || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      } catch(e){}
      applyTheme(savedTheme);
      var themeBtn = document.getElementById('themeToggle');
      if (themeBtn){
        themeBtn.addEventListener('click', function(){
          var next = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
          try { localStorage.setItem(THEME_KEY, next); } catch(e){}
          applyTheme(next);
        });
      }

      var t = document.getElementById('app-title'); if (t) t.textContent = APP_DATA.title || 'Design Pattern Cooking';

      var cats = sortCategories(APP_DATA.categories);
      if (!APP_DATA.categories[activeKey] && cats.length) activeKey = cats[0].id;
      renderNav(cats);

      var search = document.getElementById('search');
      if (search){
        search.addEventListener('input', function(e){
          var q = (e.target.value || '').toLowerCase();
          var content = document.getElementById('content');
          var nodes = content ? content.querySelectorAll('h3, p') : [];
          for (var i=0;i<nodes.length;i++){
            var text = (nodes[i].textContent || '').toLowerCase();
            nodes[i].style.display = (q && text.indexOf(q) === -1) ? 'none' : '';
          }
        });
      }
    });
  })();
  </script>
</body>
</html>
