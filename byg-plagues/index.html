<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Behold Your God â€” Teaching Kit</title>
<meta name="description" content="Single-file handout + flashcards." />
<style>
  :root{
    --bg:#0b1020; --panel:#0f172a; --ink:#e5e7eb; --muted:#94a3b8; --brand:#22d3ee;
    --chip:#1f2937; --chip-ink:#cbd5e1; --accent:#38bdf8; --border:#1e293b; --card:#111827;
  }
  @media (prefers-color-scheme: light){
    :root{ --bg:#f7fafc; --panel:#ffffff; --ink:#0f172a; --muted:#475569; --brand:#0ea5e9; --chip:#eef2ff; --chip-ink:#3730a3; --accent:#2563eb; --border:#e5e7eb; --card:#ffffff; }
  }
  body{margin:0;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:var(--bg)}
  .wrap{max-width:1000px;margin:0 auto;padding:20px}
  .hdr{position:sticky;top:0;z-index:10;background:var(--panel);border-bottom:1px solid var(--border)}
  .hdr-inner{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:14px 20px}
  .title{display:flex;gap:12px;align-items:center;font-weight:700}
  .badge{font-size:12px;padding:2px 8px;border-radius:999px;background:var(--chip);color:var(--chip-ink)}
  .tabs{display:flex;gap:8px}
  .tab{border:1px solid var(--border);background:transparent;color:var(--ink);padding:10px 14px;border-radius:999px;cursor:pointer;font-weight:600}
  /* Active tab â€” clean underline indicator (no bright fill) */
  .tab[aria-selected="true"]{
    position:relative;
    background:transparent;
    color:var(--ink);
  }
  .tab[aria-selected="true"]::after{
    content:"";
    position:absolute; left:12px; right:12px; bottom:-6px;
    height:3px; border-radius:3px; background:var(--brand);
  }
  .btn{border:1px solid var(--border);background:var(--panel);color:var(--ink);padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
  .panel{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:20px;margin:20px 0}
  .fc{border:1px solid var(--border);border-radius:18px;background:var(--card);padding:26px;min-height:220px}
  .fc-toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
  .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  .k{color:var(--muted)}
  .empty{padding:12px;border:1px dashed var(--border);border-radius:10px;color:var(--muted)}
  /* chips used in handoutHTML */
  .chips{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
  .chip{background:var(--chip);color:var(--chip-ink);border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-size:12px}
</style>
</head>
<body>
  <header class="hdr">
    <div class="hdr-inner wrap">
      <div class="title">
        <span style="width:10px;height:10px;border-radius:999px;background:var(--brand)"></span>
        <span id="headerTitle"></span>
        <span class="badge" id="badge"></span>
      </div>
      <nav class="tabs" role="tablist" aria-label="Sections">
        <button class="tab" id="t-handout" aria-selected="true" role="tab" aria-controls="tab-handout"></button>
        <button class="tab" id="t-flashcards" aria-selected="false" role="tab" aria-controls="tab-flashcards"></button>
      </nav>
      <div class="actions">
        <button class="btn" id="copyBtn" title="Copy handout"></button>
        <button class="btn" id="printBtn" title="Print handout"></button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section id="tab-handout" class="panel" role="tabpanel" aria-labelledby="t-handout">
      <div id="handout" class="empty">Loadingâ€¦</div>
    </section>

    <section id="tab-flashcards" class="panel" role="tabpanel" aria-labelledby="t-flashcards" hidden>
      <div class="fc-toolbar">
        <button class="btn" id="flipBtn"></button>
        <button class="btn" id="prevBtn"></button>
        <button class="btn" id="nextBtn"></button>
        <button class="btn" id="shuffleBtn"></button>
        <label><input type="checkbox" id="remember" /> <span id="rememberLabel"></span></label>
        <span id="progress" aria-live="polite"></span>
      </div>

      <article class="fc" id="card" aria-live="polite">
        <div class="fc-inner">
          <div class="fc-side fc-front">
            <div id="qText"></div>
            <div id="illusFront" class="k"></div>
            <div><span id="pageFront"></span> â€¢ <span id="frontHint"></span></div>
          </div>
          <div class="fc-side fc-back" hidden>
            <div id="aText"></div>
            <div id="illusBack" class="k"></div>
            <div><span id="pageBack"></span> â€¢ <span id="backHint"></span></div>
          </div>
        </div>
      </article>
      <span class="sr-only" id="flipState" aria-live="polite"></span>
    </section>
  </main>

  <footer class="wrap"><div id="footerLine"></div></footer>

  <script id="app-data" type="application/json">
  {
    "slug": "byg-plagues",
    "chapterBadge": "The Plagues",
    "pageTitle": "Behold Your God â€” â€œThe Plaguesâ€ â€” Teaching Kit",
    "metaDesc": "The plagues of Egypt as governed judgments: destructive forces restrained, bounded, and directed by Godâ€™s hand to reveal His sovereignty.",
    "headerTitle": "Behold Your God",
    "tabs": { "handout": "Handout", "flashcards": "Flashcards" },
    "buttons": { "copy":"Copy Handout", "print":"Print", "flip":"Flip", "prev":"Prev", "next":"Next", "shuffle":"Shuffle", "remember":"Remember progress" },
    "hints": { "front":"Tap Flip or press Space", "back":"Tap Next or â† / â†’" },
    "footer": "Behold Your God -- Review",
    "toasts": { "copied":"Handout copied to clipboard.", "manual":"Select & copy manually.", "shuffled":"Shuffled." },

    "handoutHTML": "<h1>â€œThe Plaguesâ€ â€” Teaching Handout</h1><div class=\"chips\"><span class=\"chip\">Theme: Governed judgments</span><span class=\"chip\">Signal: Boundaries and restraint</span><span class=\"chip\">Purpose: Revelation, not chaos</span></div><div class=\"section\"><h2>Thesis</h2><p class=\"k\">The plagues were not chaotic disasters. They were controlled, bounded judgments under Godâ€™s handâ€”measured signs designed to expose Pharaohâ€™s rebellion and reveal Godâ€™s sovereignty. Each plague had limits: time, place, and intensity. This shows Godâ€™s restraint and purpose, not blind destruction.</p></div><div class=\"section\"><h2>Key Textual Moments</h2><ul><li><strong>Exod. 7:17â€“24:</strong> Water to blood, limited to the Nile.</li><li><strong>Exod. 8:1â€“15:</strong> Frogs announced and ended at Godâ€™s word.</li><li><strong>Exod. 9:22â€“26:</strong> Hail struck Egypt but spared Goshen.</li><li><strong>Exod. 10:21â€“23:</strong> Darkness fell three days, but Israel had light.</li><li><strong>Exod. 12:29â€“30:</strong> Death of the firstborn, climactic after repeated warnings.</li></ul></div><div class=\"section\"><h2>Lessons the Author Draws</h2><ul><li><strong>Boundaries show restraint:</strong> God set who was affected, where, and how long.</li><li><strong>Purpose, not vengeance:</strong> Revelation of Godâ€™s sovereignty was the goal.</li><li><strong>Contrast with chaos:</strong> Without God, nature destroys indiscriminately; here it obeys limits.</li><li><strong>Magicians fail:</strong> They could imitate signs but not restrain them.</li><li><strong>Foreshadow:</strong> End-time judgments will follow the same patternâ€”measured, purposeful, restrained.</li></ul></div><div class=\"section\"><h2>Reading Cues</h2><ul><li>Notice <strong>limits</strong>: who is touched, who is spared.</li><li>Track the <strong>sequence</strong>: escalation with pauses for repentance.</li><li>Compare <strong>imitation</strong> (magicians) vs. <strong>control</strong> (God).</li><li>Ask: is this chaos or governed judgment?</li></ul></div><div class=\"section\"><h2>Discussion Prompts</h2><ul><li>How do the boundaries of the plagues reveal Godâ€™s control?</li><li>What does Pharaohâ€™s resistance show about human freedom?</li><li>Why distinguish Godâ€™s judgments from natural disasters?</li><li>How do the plagues prepare us for end-time warnings?</li><li>What comfort comes from knowing God sets limits on destructive forces?</li></ul></div>",

    "cards": [
      { "q":"Chapter in one line:", "a":"The plagues were governed judgmentsâ€”destructive forces restrained, bounded, and directed by Godâ€™s hand.", "page":"Exod. 7â€“12", "illus":"[âš¡âœ‹]" },
      { "q":"First plague â€” what boundary?", "a":"Water to blood, limited to the Nile.", "page":"Exod. 7:17â€“24", "illus":"[ğŸŒŠâ¡ï¸ğŸ©¸]" },
      { "q":"Frogs show what control?", "a":"Announced in advance, removed at Godâ€™s word.", "page":"Exod. 8:1â€“15", "illus":"[ğŸ¸â±ï¸]" },
      { "q":"What about the hail?", "a":"Struck Egypt but not Goshen, showing limits.", "page":"Exod. 9:22â€“26", "illus":"[ğŸŒ©ï¸ğŸš«ğŸ ]" },
      { "q":"Darkness signified what?", "a":"Three days total, yet Israel had light.", "page":"Exod. 10:21â€“23", "illus":"[ğŸŒ‘â˜€ï¸]" },
      { "q":"Death of the firstborn â€” key point?", "a":"Came after repeated warnings and opportunities to repent.", "page":"Exod. 12:29â€“30", "illus":"[âš°ï¸â³]" },
      { "q":"What do boundaries teach?", "a":"Godâ€™s restraint; judgments were limited, not chaotic.", "page":"â€”", "illus":"[ğŸ“â±ï¸]" },
      { "q":"What could the magicians doâ€”and not do?", "a":"They could imitate signs but not restrain or reverse them.", "page":"Exod. 7â€“8", "illus":"[ğŸ­â‰ ğŸ§­]" },
      { "q":"What was Godâ€™s purpose in the plagues?", "a":"To reveal His sovereignty, not to indulge vengeance.", "page":"â€”", "illus":"[ğŸ‘‘âœ¨]" },
      { "q":"Reader cue:", "a":"Look for limits, sequence, and pausesâ€”marks of governed judgment.", "page":"â€”", "illus":"[ğŸ”ğŸ“]" }
    ]
  }
  </script>
  <script>
/* ================= REUSABLE LOADER (unchanged across chapters) ================= */
(function(){
  const fallback = {
    slug:"app",
    chapterBadge:"",
    pageTitle:"Behold Your God â€” Teaching Kit",
    metaDesc:"Single-file handout + flashcards.",
    headerTitle:"Behold Your God",
    tabs:{handout:"Handout", flashcards:"Flashcards"},
    buttons:{copy:"Copy Handout", print:"Print", flip:"Flip", prev:"Prev", next:"Next", shuffle:"Shuffle", remember:"Remember progress"},
    hints:{front:"Tap Flip or press Space", back:"Tap Next or â† / â†’"},
    footer:"Single-file app â€¢ System fonts â€¢ No external dependencies.",
    toasts:{copied:"Handout copied to clipboard.", manual:"Select & copy manually.", shuffled:"Shuffled."},
    handoutHTML:"",
    cards:[]
  };

  const cfg = readConfig();
  loadApp(cfg);

  function readConfig(){
    try{
      const el = document.getElementById('app-data');
      const txt = (el?.textContent || "").trim();
      if(!txt) return fallback;
      const obj = JSON.parse(txt);
      return deepMerge(fallback, obj);
    }catch{ return fallback; }
  }
  function deepMerge(a,b){
    const out = {...a};
    for(const k in b){
      if(b[k] && typeof b[k]==='object' && !Array.isArray(b[k])){
        out[k] = deepMerge(a[k]||{}, b[k]);
      }else{
        out[k] = b[k];
      }
    }
    return out;
  }

  function loadApp(cfg){
    // Meta + header
    document.title = cfg.pageTitle || fallback.pageTitle;
    const meta = document.querySelector('meta[name="description"]');
    if(meta) meta.setAttribute('content', cfg.metaDesc || fallback.metaDesc);
    T('headerTitle', cfg.headerTitle || fallback.headerTitle);
    T('badge', cfg.chapterBadge || "");

    // Tabs & buttons
    T('t-handout', cfg.tabs?.handout || fallback.tabs.handout);
    T('t-flashcards', cfg.tabs?.flashcards || fallback.tabs.flashcards);
    T('copyBtn', cfg.buttons?.copy || fallback.buttons.copy);
    T('printBtn', cfg.buttons?.print || fallback.buttons.print);
    T('flipBtn', cfg.buttons?.flip || fallback.buttons.flip);
    T('prevBtn', cfg.buttons?.prev || fallback.buttons.prev);
    T('nextBtn', cfg.buttons?.next || fallback.buttons.next);
    T('shuffleBtn', cfg.buttons?.shuffle || fallback.buttons.shuffle);
    T('rememberLabel', cfg.buttons?.remember || fallback.buttons.remember);
    T('frontHint', cfg.hints?.front || fallback.hints.front);
    T('backHint',  cfg.hints?.back  || fallback.hints.back);
    T('footerLine', cfg.footer || fallback.footer);

    // Handout
    const handoutEl = G('handout');
    if(cfg.handoutHTML && cfg.handoutHTML.trim()){
      handoutEl.classList.remove('empty');
      handoutEl.innerHTML = cfg.handoutHTML;
    }else{
      handoutEl.classList.add('empty');
      handoutEl.innerHTML = 'No handout content.';
    }

    // Tabs
    const tabs = {
      handout: { btn: G('t-handout'),   panel: G('tab-handout') },
      flash:   { btn: G('t-flashcards'), panel: G('tab-flashcards') }
    };
    const showTab = (which)=>{
      Object.values(tabs).forEach(v=>{ v.btn.setAttribute('aria-selected','false'); v.panel.hidden = true; });
      tabs[which].btn.setAttribute('aria-selected','true'); tabs[which].panel.hidden = false;
    };
    tabs.handout.btn.addEventListener('click', ()=>showTab('handout'));
    tabs.flash.btn.addEventListener('click', ()=>showTab('flash'));

    // Copy & print
    G('copyBtn').addEventListener('click', async ()=>{
      const text = G('handout').innerText.replace(/\n{3,}/g, '\n\n').trim();
      try{ await navigator.clipboard.writeText(text); toast(cfg.toasts?.copied || fallback.toasts.copied); }
      catch{
        const ta=document.createElement('textarea'); ta.value=text; ta.style.position='fixed'; ta.style.opacity='0';
        document.body.appendChild(ta); ta.focus(); ta.select();
        try{ document.execCommand('copy'); toast(cfg.toasts?.copied || fallback.toasts.copied); }
        catch{ toast(cfg.toasts?.manual || fallback.toasts.manual); }
        ta.remove();
      }
    });
    G('printBtn').addEventListener('click', ()=>window.print());

    // Flashcards
    const hasCards = Array.isArray(cfg.cards) && cfg.cards.length>0;
    const cardEl = G('card'), qEl=G('qText'), aEl=G('aText'),
          illusF=G('illusFront'), illusB=G('illusBack'),
          pageF=G('pageFront'),  pageB=G('pageBack'),
          progress=G('progress'), remember=G('remember'),
          front = cardEl.querySelector('.fc-front'),
          back  = cardEl.querySelector('.fc-back'),
          srFlip=G('flipState');

    const LS_KEY = (cfg.slug || 'app') + '-fc';
    let order = hasCards ? cfg.cards.map((_,i)=>i) : [];
    let idx = 0, flipped = false;

    try{
      const saved = localStorage.getItem(LS_KEY);
      if(saved){
        const s = JSON.parse(saved);
        if(Array.isArray(s.order) && s.order.length===order.length) order = s.order;
        if(Number.isInteger(s.idx)) idx = Math.min(Math.max(0,s.idx), Math.max(order.length-1,0));
        flipped = !!s.flipped; remember.checked = true;
      }
    }catch{}

    function current(){ return hasCards ? cfg.cards[ order[idx] ] : {q:'',a:'',page:'',illus:''}; }
    function render(){
      const c = current();
      qEl.innerHTML = c.q || '';
      aEl.textContent = c.a || '';
      illusF.textContent = c.illus || '';
      illusB.textContent = c.illus || '';
      pageF.textContent = c.page || '';
      pageB.textContent = c.page || '';
      progress.textContent = hasCards ? `Card ${idx+1} / ${cfg.cards.length}` : 'No cards';
      front.hidden = flipped;
      back.hidden  = !flipped;
      srFlip.textContent = flipped ? "Answer shown" : "Question shown";
      if(remember.checked){
        localStorage.setItem(LS_KEY, JSON.stringify({order, idx, flipped}));
      }
      ['flipBtn','prevBtn','nextBtn','shuffleBtn'].forEach(id=>G(id).disabled = !hasCards);
    }
    function flip(){ if(!hasCards) return; flipped = !flipped; render(); }
    function next(){ if(!hasCards) return; idx = (idx+1) % order.length; flipped=false; render(); }
    function prev(){ if(!hasCards) return; idx = (idx-1+order.length) % order.length; flipped=false; render(); }
    function shuffle(){
      if(!hasCards) return;
      for(let i=order.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [order[i],order[j]]=[order[j],order[i]];
      }
      idx=0; flipped=false; render(); toast(cfg.toasts?.shuffled || fallback.toasts.shuffled);
    }

    G('flipBtn').addEventListener('click', flip);
    G('nextBtn').addEventListener('click', next);
    G('prevBtn').addEventListener('click', prev);
    G('shuffleBtn').addEventListener('click', shuffle);
    remember.addEventListener('change', ()=>{ if(!remember.checked) localStorage.removeItem(LS_KEY); });

    document.addEventListener('keydown', (e)=>{
      if(G('t-flashcards').getAttribute('aria-selected')!=='true') return;
      if(e.key===' '){ e.preventDefault(); flip(); }
      if(e.key==='ArrowRight') next();
      if(e.key==='ArrowLeft')  prev();
    });

    // Initial paint
    render();
  }

  // helpers
  function G(id){ return document.getElementById(id); }
  function T(id, txt){ const el=G(id); if(el) el.textContent = txt; }
  function toast(msg){
    const n=document.createElement('div');
    n.textContent=msg;
    Object.assign(n.style,{
      position:'fixed',bottom:'18px',left:'50%',transform:'translateX(-50%)',
      background:'var(--panel)',color:'var(--ink)',border:'1px solid var(--border)',
      padding:'10px 14px',borderRadius:'10px',boxShadow:'0 6px 20px rgba(0,0,0,.18)'
    });
    document.body.appendChild(n); setTimeout(()=>n.remove(),1800);
  }
})();
</script>
</body>
</html>
