<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joseph Campbell's Hero's Journey Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary-color-50: #f0f9ff;
            --primary-color-100: #e0f2fe;
            --primary-color-500: #0ea5e9;
            --primary-color-600: #0284c7;
            --primary-color-700: #0369a1;

            --neutral-color-50: #f8fafc;
            --neutral-color-100: #f1f5f9;
            --neutral-color-200: #e2e8f0;
            --neutral-color-300: #cbd5e1;
            --neutral-color-500: #64748b;
            --neutral-color-600: #475569;
            --neutral-color-700: #334155;
            --neutral-color-800: #1e293b;

            --space-1: 0.5rem;
            --space-2: 1rem;
            --space-3: 1.5rem;
            --space-4: 2rem;
        }
        body {
            font-family: 'Inter', system-ui, sans-serif;
            background-color: var(--neutral-color-100);
            color: var(--neutral-color-700);
            line-height: 1.6;
        }
        h1, h2, h3, h4 {
            color: var(--neutral-color-800);
            line-height: 1.3;
            font-weight: 600;
        }
        h1 { font-size: clamp(2rem, 5vw, 2.5rem); margin-bottom: var(--space-3); }
        h2 { font-size: clamp(1.5rem, 4vw, 2rem); margin-bottom: var(--space-2); }

        /* Tab Navigation */
        .tab-button {
            padding: var(--space-2) var(--space-3);
            margin-right: var(--space-1);
            border-radius: 0.375rem 0.375rem 0 0;
            background-color: var(--neutral-color-200);
            color: var(--neutral-color-600);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 1px solid transparent;
            border-bottom: none;
        }
        .tab-button:hover {
            background-color: var(--neutral-color-300);
            color: var(--primary-color-600);
        }
        .tab-button.active {
            background-color: white;
            color: var(--primary-color-700);
            border-color: var(--neutral-color-300);
            border-bottom: 1px solid white;
            position: relative;
            top: 1px;
        }
        .tab-content {
            display: none;
            background-color: white;
            padding: var(--space-4);
            border: 1px solid var(--neutral-color-300);
            border-top: none;
            border-radius: 0 0 0.375rem 0.375rem;
            min-height: 500px;
        }
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }

        /* Card Styling */
        .card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0,0,0,0.07);
            padding: var(--space-3);
            margin-bottom: var(--space-3);
            transition: box-shadow 0.2s ease-in-out;
            border: 1px solid var(--neutral-color-200);
        }
        .card:hover {
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }
        .clickable-card { cursor: pointer; }
        
        .tag {
            display: inline-block;
            background-color: var(--primary-color-100);
            color: var(--primary-color-700);
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.25rem 0.5rem;
            margin-right: 0.25rem;
            border-radius: 0.25rem;
        }

        /* Layout */
        .main-grid {
             display: grid;
             grid-template-columns: 1fr;
             gap: var(--space-4);
        }
        @media (min-width: 768px) {
             .main-grid { grid-template-columns: minmax(280px, 1fr) 2fr; }
        }
        .list-container {
            max-height: calc(80vh - 100px);
            overflow-y: auto;
            padding-right: var(--space-1);
        }

        /* Generator Input Styles */
        .generator-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--neutral-color-200);
            border-radius: 0.5rem;
            font-size: 1.1rem;
            transition: border-color 0.2s;
        }
        .generator-input:focus {
            outline: none;
            border-color: var(--primary-color-500);
        }
        
        /* Generated Timeline */
        .journey-step {
            position: relative;
            padding-left: 2.5rem;
            margin-bottom: 2rem;
            border-left: 2px solid var(--primary-color-100);
        }
        .journey-step:last-child { border-left: 2px solid transparent; }
        
        .step-marker {
            position: absolute;
            left: -13px;
            top: 0;
            width: 24px;
            height: 24px;
            background: var(--primary-color-600);
            color: white;
            border-radius: 50%;
            text-align: center;
            font-size: 0.8rem;
            line-height: 24px;
            font-weight: bold;
            box-shadow: 0 0 0 4px white;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes spin { to { transform: rotate(360deg); } }

        .spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
    </style>
</head>
<body class="min-h-screen antialiased text-base">
    <div class="container mx-auto p-4 md:p-6 lg:p-8 max-w-7xl">
        <header class="text-center py-6 mb-6">
            <h1 class="text-3xl md:text-4xl font-bold" style="color: var(--primary-color-700);">Joseph Campbell's Hero's Journey Explorer</h1>
            <p class="text-lg" style="color: var(--neutral-color-600);">Map the Monomyth to any story, real or imagined.</p>
        </header>

        <nav id="mainNav" class="mb-6 border-b border-neutral-300 flex flex-wrap">
            <button class="tab-button active" data-tab="stages">The 12 Stages</button>
            <button class="tab-button" data-tab="generator">Journey Generator</button>
            <button class="tab-button" data-tab="examples">Static Examples</button>
            <button class="tab-button" data-tab="glossary">Glossary</button>
            <button class="tab-button" data-tab="meta">About</button>
        </nav>

        <main>
            <section id="stagesContent" class="tab-content active">
                <div class="prose mx-auto mb-6 text-center">
                    <h2 class="text-3xl font-bold" style="color: var(--primary-color-700);">The Monomyth Cycle</h2>
                </div>
                <div class="main-grid">
                    <div id="stagesList" class="list-container space-y-2"></div>
                    <div id="stageDetail" class="detail-area prose">
                        <p class="text-center text-lg text-neutral-500 mt-10">Select a stage to explore its meaning.</p>
                    </div>
                </div>
            </section>

            <section id="generatorContent" class="tab-content">
                <div class="max-w-3xl mx-auto">
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold" style="color: var(--primary-color-700);">Map a New Hero</h2>
                        <p class="text-neutral-600 mt-2">Enter any character name (fictional, historical, or your own) to generate their 12-stage journey.</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-neutral-200 mb-8">
                        <div class="grid gap-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-1">Hero Name</label>
                                <input type="text" id="heroName" class="generator-input" placeholder="e.g., Batman, Simba, Marie Curie...">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-1">Context (Optional)</label>
                                <input type="text" id="heroContext" class="generator-input" placeholder="e.g., The Dark Knight Trilogy, The Lion King, Historical Biography">
                            </div>
                            <button onclick="generateJourney()" id="genBtn" class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-6 rounded-lg transition-colors shadow-md flex justify-center items-center">
                                <span>Generate Journey</span>
                            </button>
                        </div>
                    </div>

                    <div id="journeyOutput" class="space-y-4"></div>
                </div>
            </section>

            <section id="examplesContent" class="tab-content">
                <div class="prose mx-auto mb-6 text-center">
                    <h2 class="text-3xl font-bold" style="color: var(--primary-color-700);">Classic Examples</h2>
                </div>
                <div class="main-grid">
                    <div id="examplesList" class="list-container space-y-2"></div>
                    <div id="exampleDetail" class="detail-area prose">
                         <p class="text-center text-lg text-neutral-500 mt-10">Select a hero to trace their journey.</p>
                    </div>
                </div>
            </section>

            <section id="glossaryContent" class="tab-content">
                <div class="prose mx-auto mb-6 text-center">
                    <h2 class="text-3xl font-bold" style="color: var(--primary-color-700);">Glossary</h2>
                </div>
                <div class="main-grid">
                    <div id="glossaryList" class="list-container space-y-2"></div>
                    <div id="glossaryDetail" class="detail-area prose">
                        <p class="text-center text-lg text-neutral-500 mt-10">Select a term to define it.</p>
                    </div>
                </div>
            </section>

            <section id="metaContent" class="tab-content">
                <div class="prose mx-auto mb-6">
                    <h2 class="text-center">About</h2>
                    <div id="metaDetail"></div>
                </div>
            </section>
        </main>

        <footer class="text-center mt-12 py-6 border-t border-neutral-300">
            <p class="text-sm" style="color: var(--neutral-color-500);">Knowledge Base Explorer SPA. Version <span id="kbVersion"></span>.</p>
        </footer>
    </div>

    <script>
        // *** API KEY CONFIGURED ***
        const API_KEY = "AIzaSyBjL7zhEjoBgqCaXCxID3hV9KZNaPm5M8A";

        // --- STATIC DATA ---
        const kbData = {
            stages: [
                { title: "1. Ordinary World", body: "The hero is shown in their familiar environment, revealing everyday routines, relationships, and underlying tensions that signal a need for change." },
                { title: "2. Call to Adventure", body: "A disruptive event—messenger, discovery, or inner yearning—invites the hero to leave the status quo." },
                { title: "3. Refusal of the Call", body: "Fear, insecurity, or obligation causes the hero to balk. This hesitation heightens dramatic tension." },
                { title: "4. Meeting with the Mentor", body: "A wiser figure provides guidance, training, or a talisman that boosts the hero’s confidence." },
                { title: "5. Crossing the Threshold", body: "The hero commits to the adventure, entering a realm of unknown rules and dangers." },
                { title: "6. Tests, Allies, Enemies", body: "In the special world, the hero faces trials, gathers allies, and confronts adversaries." },
                { title: "7. Approach to Inmost Cave", body: "The hero and allies prepare for a central ordeal, strategizing and confronting inner doubts." },
                { title: "8. The Ordeal", body: "A climactic crisis—often life-or-death—pushes the hero to the brink, forcing a metaphorical death and rebirth." },
                { title: "9. Reward", body: "Having survived the ordeal, the hero claims the treasure—physical prize, secret knowledge, or reconciliation." },
                { title: "10. The Road Back", body: "The hero recommits to finishing the adventure, heading toward home or a final showdown." },
                { title: "11. Resurrection", body: "A final, often cosmic test purifies the hero; lessons learned are applied under maximum pressure." },
                { title: "12. Return with Elixir", body: "The hero brings back the boon—wisdom, healing, or literal treasure—to benefit the ordinary world." }
            ],
            examples: [
                { title: "Neo (The Matrix)", body: "Neo begins in the mundane world of Thomas Anderson. His call is the message 'Follow the white rabbit'. Morpheus acts as the Mentor. The red pill is the Threshold. He battles Agents (Enemies) and trains with the crew (Allies). His Resurrection occurs when he stops the bullets and sees the code." },
                { title: "Frodo Baggins", body: "Frodo starts in the Shire. The Ring is his Call. Gandalf is the Mentor. Leaving the Shire crosses the Threshold. The Fellowship are his Allies; the Nazgul his Enemies. The Ordeal is Shelob's Lair and Mt Doom. The Elixir is the peace brought to Middle Earth, though he cannot stay." }
            ],
            glossary: [
                { title: "Archetype", body: "A universally understood symbol, term, or pattern of behavior; a prototype upon which others are copied." },
                { title: "Monomyth", body: "Campbell's term for the common template of hero stories: A hero ventures forth from the world of common day into a region of supernatural wonder." }
            ],
            meta: { version: "2.0 (AI Enabled)", description: "A Single-Page Application exploring Joseph Campbell's Monomyth. Enter a character name in the Generator tab to see their story mapped to the 12 stages." }
        };

        // --- UI Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const mainNav = document.getElementById('mainNav');
            const tabContents = document.querySelectorAll('.tab-content');

            // Tab Switching
            mainNav.addEventListener('click', (e) => {
                if (e.target.classList.contains('tab-button')) {
                    const tabId = e.target.dataset.tab;
                    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabId}Content`) {
                            content.classList.add('active');
                        }
                    });
                }
            });

            renderLists();
            displayMeta();
        });

        // --- Rendering Helpers ---
        function renderLists() {
            // Render Stages
            const stagesList = document.getElementById('stagesList');
            kbData.stages.forEach(item => {
                const card = createCard(item.title, () => showDetail('stageDetail', item));
                stagesList.appendChild(card);
            });

            // Render Examples
            const exList = document.getElementById('examplesList');
            kbData.examples.forEach(item => {
                const card = createCard(item.title, () => showDetail('exampleDetail', item));
                exList.appendChild(card);
            });

            // Render Glossary
            const glossList = document.getElementById('glossaryList');
            kbData.glossary.forEach(item => {
                const card = createCard(item.title, () => showDetail('glossaryDetail', item));
                glossList.appendChild(card);
            });
        }

        function createCard(title, onClick) {
            const div = document.createElement('div');
            div.className = 'card clickable-card hover:border-sky-400 cursor-pointer';
            div.innerHTML = `<h3 class="font-medium text-slate-700">${title}</h3>`;
            div.onclick = onClick;
            return div;
        }

        function showDetail(containerId, item) {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-sky-700 mb-3">${item.title}</h3>
                <p class="text-lg leading-relaxed">${item.body}</p>
            `;
        }

        function displayMeta() {
            const meta = document.getElementById('metaDetail');
            if (meta) meta.innerHTML = `<p>${kbData.meta.description}</p>`;
            const versionEl = document.getElementById('kbVersion');
            if (versionEl) versionEl.innerText = kbData.meta.version;
        }

        // --- AI GENERATOR LOGIC (Using gemini-1.5-flash) ---
        async function generateJourney() {
            const name = document.getElementById('heroName').value;
            const context = document.getElementById('heroContext').value;
            const btn = document.getElementById('genBtn');
            const output = document.getElementById('journeyOutput');

            if (!name) return alert("Please enter a hero name.");

            // Loading State
            btn.innerHTML = '<div class="spinner"></div>';
            btn.disabled = true;
            output.innerHTML = '';

            try {
                const systemPrompt = `
                    You are a master mythologist. 
                    Task: Map the character's story to Joseph Campbell's 12 Stages of the Hero's Journey.
                    Format: JSON Array of objects.
                    IMPORTANT: Return strictly valid JSON. Do not include Markdown formatting like \`\`\`json or \`\`\`.
                    Schema: 
                    [
                        { "stage": "1. Ordinary World", "analysis": "Specific detail about the hero..." },
                        ... for all 12 stages
                    ]
                `;

                const userPrompt = `Hero: ${name}. Context: ${context || 'General Knowledge'}.`;

                const payload = {
                    contents: [{
                        role: "user",
                        parts: [{ text: systemPrompt + "\n" + userPrompt }]
                    }],
                    generationConfig: { responseMimeType: "application/json" }
                };

                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`,
                    {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(payload)
                    }
                );

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.error) throw new Error(data.error.message);
                if (!data.candidates || !data.candidates[0]) throw new Error("No response from Oracle.");

                // Clean up response just in case model ignores system instruction regarding markdown
                let rawText = data.candidates[0].content.parts[0].text;
                rawText = rawText.replace(/```json/g, '').replace(/```/g, '').trim();

                const result = JSON.parse(rawText);
                renderJourney(result, name);

            } catch (e) {
                output.innerHTML = `<div class="p-4 bg-red-50 text-red-600 border border-red-200 rounded">Error: ${e.message}</div>`;
            } finally {
                btn.innerHTML = '<span>Generate Journey</span>';
                btn.disabled = false;
            }
        }

        function renderJourney(stages, heroName) {
            const output = document.getElementById('journeyOutput');
            let html = `<h3 class="text-2xl font-bold mb-6 text-center">The Journey of ${heroName}</h3>`;
            
            stages.forEach((step, index) => {
                html += `
                    <div class="journey-step">
                        <div class="step-marker">${index + 1}</div>
                        <div class="bg-white p-4 rounded-lg border border-neutral-200 shadow-sm hover:shadow-md transition-shadow">
                            <h4 class="font-bold text-sky-700 mb-1">${step.stage}</h4>
                            <p class="text-neutral-600 text-sm md:text-base">${step.analysis}</p>
                        </div>
                    </div>
                `;
            });

            output.innerHTML = html;
        }
    </script>
</body>
</html>
