<!-- ... keep all HTML above the script exactly the same ... -->

    <script>
        const APP_ID = "as-ww2-battle-"; 

        // --- Navigation Logic (Debug Version) ---
        function launchMission(event) {
            // 1. Confirm the function actually ran
            console.log("Launch sequence initiated.");
            
            if (event) event.preventDefault(); 
            
            const input = document.getElementById('battleRequest');
            const btn = document.getElementById('launchBtn');
            const query = input.value.trim();
            
            if (!query) {
                alert("Please enter a battle name first.");
                return;
            }

            // 2. Confirm we have a query
            console.log("Target locked:", query);

            // 3. Visual Feedback
            btn.innerText = "Mobilizing...";
            btn.disabled = true;
            
            // 4. Attempt Redirection
            // We use a slight delay to ensure the UI updates first
            setTimeout(() => {
                const targetUrl = `index.html?q=${encodeURIComponent(query)}`;
                console.log("Redirecting to:", targetUrl);
                
                // Force the browser to go there
                window.location.assign(targetUrl);
            }, 100);
        }

        // --- Archive Loading Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            console.log("Hub Loaded. Scanning archives...");
            const grid = document.getElementById('grid');
            const emptyState = document.getElementById('emptyState');
            
            const keys = Object.keys(localStorage).filter(k => k.startsWith(APP_ID));

            if (keys.length === 0) {
                emptyState.classList.remove('hidden');
                return;
            }

            keys.forEach(key => {
                try {
                    const data = JSON.parse(localStorage.getItem(key));
                    const card = document.createElement('a');
                    card.href = `index.html?q=${encodeURIComponent(data.title)}`;
                    card.className = 'card';
                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-3">
                            <span class="tag">REPORT READY</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2 text-[--brand]">${data.title}</h3>
                        <p class="text-sm text-[#a7b0cc] line-clamp-3 mb-4 flex-grow">${data.summary}</p>
                        <div class="text-xs text-[#59658a] pt-3 border-t border-[#26325b] mt-auto">
                            Source: ${data.sources?.primary ? "Primary Docs" : "Archives"}
                        </div>
                    `;
                    grid.appendChild(card);
                } catch (e) {
                    console.error("Corrupt intel:", key);
                }
            });
        });
    </script>
</body>
</html>
